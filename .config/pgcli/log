2022-12-23 09:09:33,848 (72805/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2022-12-23 09:09:33,848 (72805/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
2022-12-23 09:10:10,380 (72935/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2022-12-23 09:10:10,380 (72935/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
2022-12-23 09:15:34,924 (73314/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2022-12-23 09:15:34,924 (73314/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
2022-12-23 09:15:49,191 (73439/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2022-12-23 09:15:49,191 (73439/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
2022-12-23 09:16:20,974 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE TABLE user (\n  id BIGSERIAL NOT NULL PRIMARY KEY,\n  name VARCHAR(100) NOT NULL,\n  email VARCHAR(100) NOT NULL,\n)', error: SyntaxError('syntax error at or near "user"\nLINE 1: CREATE TABLE user (\n                     ^')
2022-12-23 09:16:20,975 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "user"\nLINE 1: CREATE TABLE user (\n                     ^\n'
2022-12-23 09:16:20,975 (73439/MainThread) pgcli.pgexecute ERROR - sql: '\\i examples/duplicated_entries.sql', error: SyntaxError('syntax error at or near "user"\nLINE 1: CREATE TABLE user (\n                     ^')
2022-12-23 09:16:20,975 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "user"\nLINE 1: CREATE TABLE user (\n                     ^\n'
2022-12-23 09:16:43,961 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE TABLE users (\n  id BIGSERIAL NOT NULL PRIMARY KEY,\n  name VARCHAR(100) NOT NULL,\n  email VARCHAR(100) NOT NULL,\n)', error: SyntaxError('syntax error at or near ")"\nLINE 5: )\n        ^')
2022-12-23 09:16:43,961 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ")"\nLINE 5: )\n        ^\n'
2022-12-23 09:16:43,961 (73439/MainThread) pgcli.pgexecute ERROR - sql: '\\i examples/duplicated_entries.sql', error: SyntaxError('syntax error at or near ")"\nLINE 5: )\n        ^')
2022-12-23 09:16:43,961 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ")"\nLINE 5: )\n        ^\n'
2022-12-23 09:16:52,621 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'INSERT INTO users VALUES (name = "Pedro", email = "pedro@antfood.com") RETURNING *', error: UndefinedColumn('column "name" does not exist\nLINE 1: INSERT INTO users VALUES (name = "Pedro", email = "pedro@ant...\n                                  ^\nHINT:  There is a column named "name" in table "users", but it cannot be referenced from this part of the query.')
2022-12-23 09:16:52,621 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "name" does not exist\nLINE 1: INSERT INTO users VALUES (name = "Pedro", email = "pedro@ant...\n                                  ^\nHINT:  There is a column named "name" in table "users", but it cannot be referenced from this part of the query.\n'
2022-12-23 09:16:52,622 (73439/MainThread) pgcli.pgexecute ERROR - sql: '\\i examples/duplicated_entries.sql', error: UndefinedColumn('column "name" does not exist\nLINE 1: INSERT INTO users VALUES (name = "Pedro", email = "pedro@ant...\n                                  ^\nHINT:  There is a column named "name" in table "users", but it cannot be referenced from this part of the query.')
2022-12-23 09:16:52,622 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "name" does not exist\nLINE 1: INSERT INTO users VALUES (name = "Pedro", email = "pedro@ant...\n                                  ^\nHINT:  There is a column named "name" in table "users", but it cannot be referenced from this part of the query.\n'
2022-12-23 09:22:05,468 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT *,\n        row_number() OVER (PARTITION BY name ORDER BY id) as rn\n        FROM recording_instrumentations', error: UndefinedTable('relation "recording_instrumentations" does not exist\nLINE 3:         FROM recording_instrumentations\n                     ^')
2022-12-23 09:22:05,468 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_instrumentations" does not exist\nLINE 3:         FROM recording_instrumentations\n                     ^\n'
2022-12-23 09:28:57,928 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT *,\n        OVER (PARTITION BY id) as rn\n        FROM users\n        ORDER BY id', error: SyntaxError('syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY id) as rn\n                                ^')
2022-12-23 09:28:57,928 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY id) as rn\n                                ^\n'
2022-12-23 09:32:28,721 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT *,\n        OVER (PARTITION BY id)\n        FROM users\n        ORDER BY id', error: SyntaxError('syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY id)\n                                ^')
2022-12-23 09:32:28,721 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY id)\n                                ^\n'
2022-12-23 09:32:53,775 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT *,\n        OVER (PARTITION BY name)\n        FROM users\n        ORDER BY id', error: SyntaxError('syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY name)\n                                ^')
2022-12-23 09:32:53,776 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY name)\n                                ^\n'
2022-12-23 09:33:08,491 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT *,\n        OVER (PARTITION BY name ORDER BY id)\n        FROM users\n        ORDER BY id', error: SyntaxError('syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY name ORDER BY id)\n                                ^')
2022-12-23 09:33:08,491 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "BY"\nLINE 2:         OVER (PARTITION BY name ORDER BY id)\n                                ^\n'
2022-12-23 09:45:40,598 (73439/MainThread) pgcli.pgexecute ERROR - sql: "INSERT INTO products(name, email) VALUES ('t-shirt', 5) RETURNING *", error: UndefinedColumn('column "email" of relation "products" does not exist\nLINE 1: INSERT INTO products(name, email) VALUES (\'t-shirt\', 5) RETU...\n                                   ^')
2022-12-23 09:45:40,598 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "email" of relation "products" does not exist\nLINE 1: INSERT INTO products(name, email) VALUES (\'t-shirt\', 5) RETU...\n                                   ^\n'
2022-12-23 09:45:40,598 (73439/MainThread) pgcli.pgexecute ERROR - sql: '\\i examples/products.sql', error: UndefinedColumn('column "email" of relation "products" does not exist\nLINE 1: INSERT INTO products(name, email) VALUES (\'t-shirt\', 5) RETU...\n                                   ^')
2022-12-23 09:45:40,599 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "email" of relation "products" does not exist\nLINE 1: INSERT INTO products(name, email) VALUES (\'t-shirt\', 5) RETU...\n                                   ^\n'
2022-12-23 09:45:58,175 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'clear', error: SyntaxError('syntax error at or near "clear"\nLINE 1: clear\n        ^')
2022-12-23 09:45:58,176 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "clear"\nLINE 1: clear\n        ^\n'
2022-12-23 09:46:36,347 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT name, AVG(cost) from products', error: GroupingError('column "products.name" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT name, AVG(cost) from products\n               ^')
2022-12-23 09:46:36,348 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "products.name" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT name, AVG(cost) from products\n               ^\n'
2022-12-23 09:48:38,519 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'p', error: SyntaxError('syntax error at or near "p"\nLINE 1: p\n        ^')
2022-12-23 09:48:38,519 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "p"\nLINE 1: p\n        ^\n'
2022-12-23 09:48:40,258 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT id, name, AVG(cost)\n        FROM products\n        GROUP BY name', error: GroupingError('column "products.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT id, name, AVG(cost)\n               ^')
2022-12-23 09:48:40,258 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "products.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT id, name, AVG(cost)\n               ^\n'
2022-12-23 09:53:26,137 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT id, name, AVG() OVER ( PARTITION BY name ORDER BY id) FROM products ORDER BY id', error: UndefinedFunction('function avg() does not exist\nLINE 1: SELECT id, name, AVG() OVER ( PARTITION BY name ORDER BY id)...\n                         ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.')
2022-12-23 09:53:26,138 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function avg() does not exist\nLINE 1: SELECT id, name, AVG() OVER ( PARTITION BY name ORDER BY id)...\n                         ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2022-12-23 09:59:33,672 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'k+---------+---------------------+\n        | name    | avg                 |\n        |---------+---------------------|\n        | shoes   | 24.6666666666666667 |\n        | t-shirt | 12.5000000000000000 |\n        | jeans   | 70.0000000000000000 |\n        +---------+---------------------+', error: SyntaxError('syntax error at or near "k"\nLINE 1: k+---------+---------------------+\n        ^')
2022-12-23 09:59:33,672 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "k"\nLINE 1: k+---------+---------------------+\n        ^\n'
2022-12-23 10:06:10,882 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT name,\n           COUNT(name) OVER ( PARTITION BY name ORDER BY name)\n        FROM products\n        ORDER BY COUNT(name)', error: GroupingError('column "products.name" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT name,\n               ^')
2022-12-23 10:06:10,882 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "products.name" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT name,\n               ^\n'
2022-12-24 08:47:23,823 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT * from names', error: UndefinedTable('relation "names" does not exist\nLINE 1: SELECT * from names\n                      ^')
2022-12-24 08:47:23,823 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "names" does not exist\nLINE 1: SELECT * from names\n                      ^\n'
2023-01-01 22:24:41,079 (73439/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT id, title from compostions', error: UndefinedTable('relation "compostions" does not exist\nLINE 1: SELECT id, title from compostions\n                              ^')
2023-01-01 22:24:41,079 (73439/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "compostions" does not exist\nLINE 1: SELECT id, title from compostions\n                              ^\n'
2023-01-03 06:00:10,556 (340147/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2023-01-03 06:00:10,556 (340147/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
2023-01-03 06:02:18,082 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT DISTINCT recording_id, COUNT(*)\nFROM recording_instrumentations\nWHERE instrumentation id = 8 OR instrumentation_id = 11\nHAVING COUNT(*) > 1', error: SyntaxError('syntax error at or near "id"\nLINE 3: WHERE instrumentation id = 8 OR instrumentation_id = 11\n                              ^')
2023-01-03 06:02:18,082 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "id"\nLINE 3: WHERE instrumentation id = 8 OR instrumentation_id = 11\n                              ^\n'
2023-01-03 06:02:18,082 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: SyntaxError('syntax error at or near "id"\nLINE 3: WHERE instrumentation id = 8 OR instrumentation_id = 11\n                              ^')
2023-01-03 06:02:18,082 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "id"\nLINE 3: WHERE instrumentation id = 8 OR instrumentation_id = 11\n                              ^\n'
2023-01-03 06:02:24,641 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT DISTINCT recording_id, COUNT(*)\nFROM recording_instrumentations\nWHERE instrumentation_id = 8 OR instrumentation_id = 11\nHAVING COUNT(*) > 1', error: GroupingError('column "recording_instrumentations.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT DISTINCT recording_id, COUNT(*)\n                        ^')
2023-01-03 06:02:24,641 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "recording_instrumentations.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT DISTINCT recording_id, COUNT(*)\n                        ^\n'
2023-01-03 06:02:24,641 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: GroupingError('column "recording_instrumentations.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT DISTINCT recording_id, COUNT(*)\n                        ^')
2023-01-03 06:02:24,641 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "recording_instrumentations.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT DISTINCT recording_id, COUNT(*)\n                        ^\n'
2023-01-03 06:06:54,659 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 11\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1;\n)\n\nSELECT recording_id, title FROM recordings\nWHERE recording_id IN (SELECT recording_id FROM filtered_recordings)', error: SyntaxError('syntax error at or near ";"\nLINE 6:    HAVING COUNT(*) > 1;\n                              ^')
2023-01-03 06:06:54,660 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ";"\nLINE 6:    HAVING COUNT(*) > 1;\n                              ^\n'
2023-01-03 06:06:54,660 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: SyntaxError('syntax error at or near ";"\nLINE 6:    HAVING COUNT(*) > 1;\n                              ^')
2023-01-03 06:06:54,660 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ";"\nLINE 6:    HAVING COUNT(*) > 1;\n                              ^\n'
2023-01-03 06:07:04,602 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 11\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n)\n\nSELECT recording_id, title FROM recordings\nWHERE recording_id IN (SELECT recording_id FROM filtered_recordings)', error: UndefinedColumn('column "recording_id" does not exist\nLINE 9: SELECT recording_id, title FROM recordings\n               ^')
2023-01-03 06:07:04,602 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "recording_id" does not exist\nLINE 9: SELECT recording_id, title FROM recordings\n               ^\n'
2023-01-03 06:07:04,602 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: UndefinedColumn('column "recording_id" does not exist\nLINE 9: SELECT recording_id, title FROM recordings\n               ^')
2023-01-03 06:07:04,602 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "recording_id" does not exist\nLINE 9: SELECT recording_id, title FROM recordings\n               ^\n'
2023-01-03 06:07:24,738 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 11\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n)\n\nSELECT id, title FROM recordings\nWHERE id IN (SELECT recording_id FROM filtered_recordings)', error: UndefinedColumn('column "title" does not exist\nLINE 9: SELECT id, title FROM recordings\n                   ^')
2023-01-03 06:07:24,738 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "title" does not exist\nLINE 9: SELECT id, title FROM recordings\n                   ^\n'
2023-01-03 06:07:24,738 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: UndefinedColumn('column "title" does not exist\nLINE 9: SELECT id, title FROM recordings\n                   ^')
2023-01-03 06:07:24,738 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "title" does not exist\nLINE 9: SELECT id, title FROM recordings\n                   ^\n'
2023-01-03 06:14:42,289 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT DISTINCT recording_id, COUN   FROM recording_instrumentations\n   WHERE instrumentation_id = 11\n   GROUP BY recording_id', error: UndefinedColumn('column "coun" does not exist\nLINE 1: SELECT DISTINCT recording_id, COUN   FROM recording_instrume...\n                                      ^')
2023-01-03 06:14:42,289 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "coun" does not exist\nLINE 1: SELECT DISTINCT recording_id, COUN   FROM recording_instrume...\n                                      ^\n'
2023-01-03 06:25:37,265 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT recordings.id, recordings.recording_title, instrumentations.title\n  FROM recordings\n  WHERE id IN (SELECT recording_id\n               FROM filtered_recordings)\nLEFT OUTER JOIN recordings_instrumentations\n     ON recordings.id = recording_instrumentations.recordings_id\nLEFT OUTER JOIN\n     ON instrumentations.id = recordings_instrumentations.instrumentation_id\nLIMIT 10', error: SyntaxError('syntax error at or near "LEFT"\nLINE 13: LEFT OUTER JOIN recordings_instrumentations\n         ^')
2023-01-03 06:25:37,265 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "LEFT"\nLINE 13: LEFT OUTER JOIN recordings_instrumentations\n         ^\n'
2023-01-03 06:25:37,265 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: SyntaxError('syntax error at or near "LEFT"\nLINE 13: LEFT OUTER JOIN recordings_instrumentations\n         ^')
2023-01-03 06:25:37,265 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "LEFT"\nLINE 13: LEFT OUTER JOIN recordings_instrumentations\n         ^\n'
2023-01-03 06:26:05,592 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT recordings.id, recordings.recording_title, instrumentations.title\n  FROM recordings\nLEFT OUTER JOIN recordings_instrumentations\n     ON recordings.id = recording_instrumentations.recordings_id\nLEFT OUTER JOIN\n     ON instrumentations.id = recordings_instrumentations.instrumentation_id\nLIMIT 10', error: SyntaxError('syntax error at or near "ON"\nLINE 14:      ON instrumentations.id = recordings_instrumentations.in...\n              ^')
2023-01-03 06:26:05,592 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ON"\nLINE 14:      ON instrumentations.id = recordings_instrumentations.in...\n              ^\n'
2023-01-03 06:26:05,592 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: SyntaxError('syntax error at or near "ON"\nLINE 14:      ON instrumentations.id = recordings_instrumentations.in...\n              ^')
2023-01-03 06:26:05,592 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ON"\nLINE 14:      ON instrumentations.id = recordings_instrumentations.in...\n              ^\n'
2023-01-03 06:26:55,154 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT recordings.id, recordings.recording_title, instrumentations.title\n  FROM recordings\nLEFT OUTER JOIN recordings_instrumentations\n     ON recordings.id = recording_instrumentations.recordings_id\nLEFT OUTER JOIN instrumentations\n     ON instrumentations.id = recordings_instrumentations.instrumentation_id\nLIMIT 10\n\n\n--  WHERE id IN (SELECT recording_id\n--               FROM filtered_recordings)\n--', error: UndefinedTable('relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^')
2023-01-03 06:26:55,154 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^\n'
2023-01-03 06:26:55,154 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: UndefinedTable('relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^')
2023-01-03 06:26:55,155 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^\n'
2023-01-03 06:27:03,614 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT recordings.id, recordings.recording_title, instrumentations.title\n  FROM recordings\nLEFT OUTER JOIN recordings_instrumentations\n     ON recordings.id = recordin_instrumentations.recordings_id\nLEFT OUTER JOIN instrumentations\n     ON instrumentations.id = recordings_instrumentations.instrumentation_id\nLIMIT 10\n\n\n--  WHERE id IN (SELECT recording_id\n--               FROM filtered_recordings)\n--', error: UndefinedTable('relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^')
2023-01-03 06:27:03,614 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^\n'
2023-01-03 06:27:03,614 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: UndefinedTable('relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^')
2023-01-03 06:27:03,614 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recordings_instrumentations" does not exist\nLINE 11: LEFT OUTER JOIN recordings_instrumentations\n                         ^\n'
2023-01-03 06:27:17,320 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT recordings.id, recordings.recording_title, instrumentations.title\n  FROM recordings\nLEFT OUTER JOIN recording_instrumentations\n     ON recordings.id = recording_instrumentations.recordings_id\nLEFT OUTER JOIN instrumentations\n     ON instrumentations.id = recording_instrumentations.instrumentation_id\nLIMIT 10\n\n\n--  WHERE id IN (SELECT recording_id\n--               FROM filtered_recordings)\n--', error: UndefinedColumn('column recording_instrumentations.recordings_id does not exist\nLINE 12:      ON recordings.id = recording_instrumentations.recording...\n                                 ^\nHINT:  Perhaps you meant to reference the column "recording_instrumentations.recording_id".')
2023-01-03 06:27:17,321 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column recording_instrumentations.recordings_id does not exist\nLINE 12:      ON recordings.id = recording_instrumentations.recording...\n                                 ^\nHINT:  Perhaps you meant to reference the column "recording_instrumentations.recording_id".\n'
2023-01-03 06:27:17,321 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: UndefinedColumn('column recording_instrumentations.recordings_id does not exist\nLINE 12:      ON recordings.id = recording_instrumentations.recording...\n                                 ^\nHINT:  Perhaps you meant to reference the column "recording_instrumentations.recording_id".')
2023-01-03 06:27:17,321 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column recording_instrumentations.recordings_id does not exist\nLINE 12:      ON recordings.id = recording_instrumentations.recording...\n                                 ^\nHINT:  Perhaps you meant to reference the column "recording_instrumentations.recording_id".\n'
2023-01-03 06:30:50,788 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT recordings.id, recordings.recording_title, ri.instrumentation_id\n  FROM recordings as r\n  JOIN recording_instrumentations ri\n  ON ri.recording_id = r.id\nLIMIT 10\n\n\n--  WHERE id IN (SELECT recording_id\n--               FROM filtered_recordings)\n--', error: UndefinedTable('invalid reference to FROM-clause entry for table "recordings"\nLINE 9: SELECT recordings.id, recordings.recording_title, ri.instrum...\n               ^\nHINT:  Perhaps you meant to reference the table alias "r".')
2023-01-03 06:30:50,788 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: invalid reference to FROM-clause entry for table "recordings"\nLINE 9: SELECT recordings.id, recordings.recording_title, ri.instrum...\n               ^\nHINT:  Perhaps you meant to reference the table alias "r".\n'
2023-01-03 06:30:50,788 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: UndefinedTable('invalid reference to FROM-clause entry for table "recordings"\nLINE 9: SELECT recordings.id, recordings.recording_title, ri.instrum...\n               ^\nHINT:  Perhaps you meant to reference the table alias "r".')
2023-01-03 06:30:50,788 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: invalid reference to FROM-clause entry for table "recordings"\nLINE 9: SELECT recordings.id, recordings.recording_title, ri.instrum...\n               ^\nHINT:  Perhaps you meant to reference the table alias "r".\n'
2023-01-03 06:32:45,651 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH filtered_recordings AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n),\n\nSELECT id, recording_title FROM recordings\nWHERE id IN (SELECT recording_id FROM filtered_recordings)\n\nLIMIT 10', error: SyntaxError('syntax error at or near "SELECT"\nLINE 9: SELECT id, recording_title FROM recordings\n        ^')
2023-01-03 06:32:45,652 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 9: SELECT id, recording_title FROM recordings\n        ^\n'
2023-01-03 06:32:45,652 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_test.sql', error: SyntaxError('syntax error at or near "SELECT"\nLINE 9: SELECT id, recording_title FROM recordings\n        ^')
2023-01-03 06:32:45,652 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 9: SELECT id, recording_title FROM recordings\n        ^\n'
2023-01-03 06:37:20,612 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'select r.id, r.recording_title\nFROM recordings r\nJOIN recordings_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id', error: UndefinedTable('relation "recordings_instrumentations" does not exist\nLINE 3: JOIN recordings_instrumentations ri\n             ^')
2023-01-03 06:37:20,612 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recordings_instrumentations" does not exist\nLINE 3: JOIN recordings_instrumentations ri\n             ^\n'
2023-01-03 06:37:20,612 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: UndefinedTable('relation "recordings_instrumentations" does not exist\nLINE 3: JOIN recordings_instrumentations ri\n             ^')
2023-01-03 06:37:20,612 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recordings_instrumentations" does not exist\nLINE 3: JOIN recordings_instrumentations ri\n             ^\n'
2023-01-03 06:38:23,688 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'select r.id, r.recording_title, i.title\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^')
2023-01-03 06:38:23,688 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^\n'
2023-01-03 06:38:23,688 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^')
2023-01-03 06:38:23,688 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^\n'
2023-01-03 06:39:07,145 (340147/MainThread) pgcli.pgexecute ERROR - sql: "select r.id, r.recording_title, STR_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title", error: UndefinedFunction("function str_agg(character varying, unknown) does not exist\nLINE 1: select r.id, r.recording_title, STR_AGG(i.title, ',')\n                                        ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.")
2023-01-03 06:39:07,145 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function str_agg(character varying, unknown) does not exist\nLINE 1: select r.id, r.recording_title, STR_AGG(i.title, \',\')\n                                        ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 06:39:07,145 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: UndefinedFunction("function str_agg(character varying, unknown) does not exist\nLINE 1: select r.id, r.recording_title, STR_AGG(i.title, ',')\n                                        ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.")
2023-01-03 06:39:07,145 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function str_agg(character varying, unknown) does not exist\nLINE 1: select r.id, r.recording_title, STR_AGG(i.title, \',\')\n                                        ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 06:40:15,093 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'select r.id, r.recording_title, i.title\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^')
2023-01-03 06:40:15,093 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^\n'
2023-01-03 06:40:15,093 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^')
2023-01-03 06:40:15,093 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, i.title\n               ^\n'
2023-01-03 06:41:02,451 (340147/MainThread) pgcli.pgexecute ERROR - sql: "select r.id, r.recording_title, STRING_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title", error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:41:02,451 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:41:02,451 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:41:02,451 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:41:24,791 (340147/MainThread) pgcli.pgexecute ERROR - sql: "select r.id, r.recording_title, STRING_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title", error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:41:24,791 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:41:24,791 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:41:24,791 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: select r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:41:37,138 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'j', error: SyntaxError('syntax error at or near "j"\nLINE 1: j\n        ^')
2023-01-03 06:41:37,139 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "j"\nLINE 1: j\n        ^\n'
2023-01-03 06:45:24,775 (340147/MainThread) pgcli.pgexecute ERROR - sql: "SELECT r.id, r.recording_title, STRING_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title, r.id\nHAVING i.id = 8", error: GroupingError('column "i.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 8: HAVING i.id = 8\n               ^')
2023-01-03 06:45:24,775 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "i.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 8: HAVING i.id = 8\n               ^\n'
2023-01-03 06:45:24,775 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/many_to_many.sql', error: GroupingError('column "i.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 8: HAVING i.id = 8\n               ^')
2023-01-03 06:45:24,775 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "i.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 8: HAVING i.id = 8\n               ^\n'
2023-01-03 06:49:51,617 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'clear', error: SyntaxError('syntax error at or near "clear"\nLINE 1: clear\n        ^')
2023-01-03 06:49:51,617 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "clear"\nLINE 1: clear\n        ^\n'
2023-01-03 06:50:47,150 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'q', error: SyntaxError('syntax error at or near "q"\nLINE 1: q\n        ^')
2023-01-03 06:50:47,151 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "q"\nLINE 1: q\n        ^\n'
2023-01-03 06:56:33,433 (340147/MainThread) pgcli.pgexecute ERROR - sql: "SELECT r.id, r.recording_title, STRING_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title\nLIMIT 500\n\n-- filter instrumentation by joining\n-- between around 27ms (chached) or 50ms (not cached?)", error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:56:33,433 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:56:33,433 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation_join.sql', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:56:33,434 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:56:38,553 (340147/MainThread) pgcli.pgexecute ERROR - sql: "SELECT r.id, r.recording_title, STRING_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nGROUP BY r.recording_title\nLIMIT 500\n\n-- filter instrumentation by joining\n-- between around 27ms (chached) or 50ms (not cached?)", error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:56:38,553 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:56:38,553 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation_join.sql', error: GroupingError('column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^')
2023-01-03 06:56:38,553 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT r.id, r.recording_title, STRING_AGG(i.title, \',\')\n               ^\n'
2023-01-03 06:59:36,270 (340147/MainThread) pgcli.pgexecute ERROR - sql: "SELECT r.id, r.recording_title, STRING_AGG(i.title, ',')\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nWHERE id.id = 8\nGROUP BY r.recording_title, r.id\nLIMIT 500\n\n-- filter instrumentation by joining\n-- between around 27ms (chached) or 50ms (not cached?)", error: UndefinedTable('missing FROM-clause entry for table "id"\nLINE 7: WHERE id.id = 8\n              ^')
2023-01-03 06:59:36,270 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "id"\nLINE 7: WHERE id.id = 8\n              ^\n'
2023-01-03 06:59:36,270 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation_join.sql', error: UndefinedTable('missing FROM-clause entry for table "id"\nLINE 7: WHERE id.id = 8\n              ^')
2023-01-03 06:59:36,270 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "id"\nLINE 7: WHERE id.id = 8\n              ^\n'
2023-01-03 07:05:06,533 (340147/MainThread) pgcli.pgexecute ERROR - sql: "SELECT r.id, r.recording_title, STRING_AGG(i.title, ','), COUNT(i.id) as matches\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nWHERE i.id = 8 OR i.id = 31\nGROUP BY r.recording_title, r.id, matches\nLIMIT 500\n\n-- filter instrumentation by joining\n-- with 500\n-- between around 50ms-60ms most of the time but somtimes 30ms", error: GroupingError("aggregate functions are not allowed in GROUP BY\nLINE 1: ....id, r.recording_title, STRING_AGG(i.title, ','), COUNT(i.id...\n                                                             ^")
2023-01-03 07:05:06,533 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: aggregate functions are not allowed in GROUP BY\nLINE 1: ....id, r.recording_title, STRING_AGG(i.title, \',\'), COUNT(i.id...\n                                                             ^\n'
2023-01-03 07:05:06,534 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation_join.sql', error: GroupingError("aggregate functions are not allowed in GROUP BY\nLINE 1: ....id, r.recording_title, STRING_AGG(i.title, ','), COUNT(i.id...\n                                                             ^")
2023-01-03 07:05:06,534 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: aggregate functions are not allowed in GROUP BY\nLINE 1: ....id, r.recording_title, STRING_AGG(i.title, \',\'), COUNT(i.id...\n                                                             ^\n'
2023-01-03 07:07:31,326 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT r.id, r.recording_title, COUNT(i.id) as i_count\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nWHERE i.id = 8 OR i.id = 31\nGROUP BY r.recording_title, r.id\nHAVING  i_count > 1\nLIMIT 500\n\n-- filter instrumentation by joining\n-- with 500\n-- between around 50ms-60ms most of the time but somtimes 30ms', error: UndefinedColumn('column "i_count" does not exist\nLINE 9: HAVING  i_count > 1\n                ^')
2023-01-03 07:07:31,326 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "i_count" does not exist\nLINE 9: HAVING  i_count > 1\n                ^\n'
2023-01-03 07:07:31,326 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation_join.sql', error: UndefinedColumn('column "i_count" does not exist\nLINE 9: HAVING  i_count > 1\n                ^')
2023-01-03 07:07:31,326 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "i_count" does not exist\nLINE 9: HAVING  i_count > 1\n                ^\n'
2023-01-03 08:59:39,726 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'select * from gen', error: UndefinedTable('relation "gen" does not exist\nLINE 1: select * from gen\n                      ^')
2023-01-03 08:59:39,726 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "gen" does not exist\nLINE 1: select * from gen\n                      ^\n'
2023-01-03 08:59:45,429 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'select * from information_schema', error: UndefinedTable('relation "information_schema" does not exist\nLINE 1: select * from information_schema\n                      ^')
2023-01-03 08:59:45,430 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "information_schema" does not exist\nLINE 1: select * from information_schema\n                      ^\n'
2023-01-03 08:59:52,609 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'select * from regconfigin()', error: UndefinedFunction('function regconfigin() does not exist\nLINE 1: select * from regconfigin()\n                      ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.')
2023-01-03 08:59:52,609 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function regconfigin() does not exist\nLINE 1: select * from regconfigin()\n                      ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 09:03:08,616 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),\n   by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genre\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\n\nSELECT id, recording_title FROM recordings\nWHERE id IN (SELECT recording_id FROM by_instrumentation)\nOR id IN (SELECT recording_id FROM by_genre)\nORDER BY id\nLIMIT 500\n\n\n\n-- between  50-60ms but but get some 25ms sometimes', error: UndefinedTable('relation "recording_genre" does not exist\nLINE 10:    FROM recording_genre\n                 ^')
2023-01-03 09:03:08,616 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_genre" does not exist\nLINE 10:    FROM recording_genre\n                 ^\n'
2023-01-03 09:03:08,616 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedTable('relation "recording_genre" does not exist\nLINE 10:    FROM recording_genre\n                 ^')
2023-01-03 09:03:08,616 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_genre" does not exist\nLINE 10:    FROM recording_genre\n                 ^\n'
2023-01-03 09:12:11,953 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT r.id, r.recording_title, STRING_AGG()\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON  r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.instrumentations\nWHERE r.id IN (SELECT recording_id FROM by_instrumentation)\nAND r.id IN (SELECT recording_id FROM by_genre)\nORDER BY id\nLIMIT 100\n\n\n\n-- between  50-60ms but but get some 25ms sometimes', error: UndefinedColumn('column i.instrumentations does not exist\nLINE 21:    ON ri.instrumentation_id = i.instrumentations\n                                       ^')
2023-01-03 09:12:11,954 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column i.instrumentations does not exist\nLINE 21:    ON ri.instrumentation_id = i.instrumentations\n                                       ^\n'
2023-01-03 09:12:11,954 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedColumn('column i.instrumentations does not exist\nLINE 21:    ON ri.instrumentation_id = i.instrumentations\n                                       ^')
2023-01-03 09:12:11,954 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column i.instrumentations does not exist\nLINE 21:    ON ri.instrumentation_id = i.instrumentations\n                                       ^\n'
2023-01-03 09:12:21,437 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT r.id, r.recording_title, STRING_AGG()\nFROM recordings r\nJOIN recording_instrumentations ri\n   ON  r.id = ri.recording_id\nJOIN instrumentations i\n   ON ri.instrumentation_id = i.id\nWHERE r.id IN (SELECT recording_id FROM by_instrumentation)\nAND r.id IN (SELECT recording_id FROM by_genre)\nORDER BY id\nLIMIT 100\n\n\n\n-- between  50-60ms but but get some 25ms sometimes', error: UndefinedFunction('function string_agg() does not exist\nLINE 16: SELECT r.id, r.recording_title, STRING_AGG()\n                                         ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.')
2023-01-03 09:12:21,438 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function string_agg() does not exist\nLINE 16: SELECT r.id, r.recording_title, STRING_AGG()\n                                         ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 09:12:21,438 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedFunction('function string_agg() does not exist\nLINE 16: SELECT r.id, r.recording_title, STRING_AGG()\n                                         ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.')
2023-01-03 09:12:21,438 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function string_agg() does not exist\nLINE 16: SELECT r.id, r.recording_title, STRING_AGG()\n                                         ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 09:23:21,557 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT recordings.id, recordings.title FROM\n  (SELECT r.id, r.recording_title\n  FROM recordings r\n  WHERE r.id IN (SELECT recording_id FROM by_instrumentation)\n  AND r.id IN (SELECT recording_id FROM by_genre)\n  ORDER BY id\n  LIMIT 100) recordings\n    JOIN recording_genres rg\n    ON recordings.id = rg.recording_id\n    JOIN genres g\n    ON g.id = rg.genre_id\n\n\n\n-- between  50-60ms but but get some 25ms sometimes', error: UndefinedColumn('column recordings.title does not exist\nLINE 16: SELECT recordings.id, recordings.title FROM\n                               ^')
2023-01-03 09:23:21,557 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column recordings.title does not exist\nLINE 16: SELECT recordings.id, recordings.title FROM\n                               ^\n'
2023-01-03 09:23:21,557 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedColumn('column recordings.title does not exist\nLINE 16: SELECT recordings.id, recordings.title FROM\n                               ^')
2023-01-03 09:23:21,557 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column recordings.title does not exist\nLINE 16: SELECT recordings.id, recordings.title FROM\n                               ^\n'
2023-01-03 09:24:20,730 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT recordings.id, recordings.recording_title FROM\n  (SELECT r.id, r.recording_title\n  FROM recordings r\n  WHERE r.id IN (SELECT recording_id FROM by_instrumentation)\n  AND r.id IN (SELECT recording_id FROM by_genre)\n  ) recordings\n    JOIN recording_genres rg\n    ON recordings.id = rg.recording_id\n    JOIN genres g\n    ON g.id = rg.genre_id\nLIMIT 100\nORDER BY id\n\n\n\n-- between  50-60ms but but get some 25ms sometimes', error: SyntaxError('syntax error at or near "ORDER"\nLINE 27: ORDER BY id\n         ^')
2023-01-03 09:24:20,730 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ORDER"\nLINE 27: ORDER BY id\n         ^\n'
2023-01-03 09:24:20,730 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: SyntaxError('syntax error at or near "ORDER"\nLINE 27: ORDER BY id\n         ^')
2023-01-03 09:24:20,730 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ORDER"\nLINE 27: ORDER BY id\n         ^\n'
2023-01-03 09:27:43,462 (340147/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT r.id, r.recording_title, r.genre\nFROM (\n  SELECT recordings.id, recordings.recording_title, STRING_AGG(g.title, ', ') AS genres FROM\n  (SELECT r.id, r.recording_title\n  FROM recordings r\n  WHERE r.id IN (SELECT recording_id FROM by_instrumentation)\n  AND r.id IN (SELECT recording_id FROM by_genre)\n  ) recordings\n    JOIN recording_genres rg\n    ON recordings.id = rg.recording_id\n    JOIN genres g\n    ON g.id = rg.genre_id\n  GROUP BY recordings.id, recordings.recording_title\n) r\nORDER BY id\nLIMIT 100\n\n\n\n-- between  50-60ms but but get some 25ms sometimes", error: UndefinedColumn('column r.genre does not exist\nLINE 16: SELECT r.id, r.recording_title, r.genre\n                                         ^\nHINT:  Perhaps you meant to reference the column "r.genres".')
2023-01-03 09:27:43,462 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column r.genre does not exist\nLINE 16: SELECT r.id, r.recording_title, r.genre\n                                         ^\nHINT:  Perhaps you meant to reference the column "r.genres".\n'
2023-01-03 09:27:43,462 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedColumn('column r.genre does not exist\nLINE 16: SELECT r.id, r.recording_title, r.genre\n                                         ^\nHINT:  Perhaps you meant to reference the column "r.genres".')
2023-01-03 09:27:43,462 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column r.genre does not exist\nLINE 16: SELECT r.id, r.recording_title, r.genre\n                                         ^\nHINT:  Perhaps you meant to reference the column "r.genres".\n'
2023-01-03 09:29:37,235 (340147/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT r.id, r.recording_title, r.genres\nFROM (\n  SELECT recordings.id, recordings.recording_title, STRING_AGG(g.title, ', ') AS genres FROM\n  (SELECT r.id, r.recording_title\n  FROM recordings r\n  WHERE r.id IN (SELECT recording_id FROM by_instrumentation)\n  AND r.id IN (SELECT recording_id FROM by_genre)\n  ) recordings\n    JOIN recording_genres rg\n    ON recordings.id = rg.recording_id\n    JOIN genres g\n    ON g.id = rg.genre_id\n  GROUP BY recordings.id, recordings.recording_title\n) r\n JOIN recording_instrumentations ri\n    ON r.id = ri.recording_id\n    JOIN instrumentations i\n    ON i.id = ri.instrumentations_id\n\nORDER BY id\nLIMIT 100\n\n\n\n-- between  50-60ms but but get some 25ms sometimes", error: UndefinedColumn('column ri.instrumentations_id does not exist\nLINE 33:     ON i.id = ri.instrumentations_id\n                       ^\nHINT:  Perhaps you meant to reference the column "ri.instrumentation_id".')
2023-01-03 09:29:37,235 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column ri.instrumentations_id does not exist\nLINE 33:     ON i.id = ri.instrumentations_id\n                       ^\nHINT:  Perhaps you meant to reference the column "ri.instrumentation_id".\n'
2023-01-03 09:29:37,235 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedColumn('column ri.instrumentations_id does not exist\nLINE 33:     ON i.id = ri.instrumentations_id\n                       ^\nHINT:  Perhaps you meant to reference the column "ri.instrumentation_id".')
2023-01-03 09:29:37,235 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column ri.instrumentations_id does not exist\nLINE 33:     ON i.id = ri.instrumentations_id\n                       ^\nHINT:  Perhaps you meant to reference the column "ri.instrumentation_id".\n'
2023-01-03 09:30:50,108 (340147/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT r.id, r.recording_title, r.genres, STRING_AGG(i.title, ', ')\nFROM (\n  SELECT recordings.id, recordings.recording_title, STRING_AGG(g.title, ', ') AS genres FROM\n  (SELECT r.id, r.recording_title\n  FROM recordings r\n  WHERE r.id IN (SELECT recording_id FROM by_instrumentation)\n  AND r.id IN (SELECT recording_id FROM by_genre)\n  ) recordings\n    JOIN recording_genres rg\n    ON recordings.id = rg.recording_id\n    JOIN genres g\n    ON g.id = rg.genre_id\n  GROUP BY recordings.id, recordings.recording_title\n) r\n JOIN recording_instrumentations ri\n    ON r.id = ri.recording_id\n    JOIN instrumentations i\n    ON i.id = ri.instrumentation_id\n  GROUP BY recordings.id, recordings.recording_title\nORDER BY id\nLIMIT 100\n\n\n\n-- between  50-60ms but but get some 25ms sometimes", error: UndefinedTable('missing FROM-clause entry for table "recordings"\nLINE 34:   GROUP BY recordings.id, recordings.recording_title\n                    ^')
2023-01-03 09:30:50,108 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "recordings"\nLINE 34:   GROUP BY recordings.id, recordings.recording_title\n                    ^\n'
2023-01-03 09:30:50,108 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: UndefinedTable('missing FROM-clause entry for table "recordings"\nLINE 34:   GROUP BY recordings.id, recordings.recording_title\n                    ^')
2023-01-03 09:30:50,108 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "recordings"\nLINE 34:   GROUP BY recordings.id, recordings.recording_title\n                    ^\n'
2023-01-03 09:31:03,349 (340147/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentation AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*)\n   FROM recording_genres\n   WHERE genre_id = 5\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\n\nSELECT r.id, r.recording_title, r.genres, STRING_AGG(i.title, ', ')\nFROM (\n  SELECT recordings.id, recordings.recording_title, STRING_AGG(g.title, ', ') AS genres FROM\n  (SELECT r.id, r.recording_title\n  FROM recordings r\n  WHERE r.id IN (SELECT recording_id FROM by_instrumentation)\n  AND r.id IN (SELECT recording_id FROM by_genre)\n  ) recordings\n    JOIN recording_genres rg\n    ON recordings.id = rg.recording_id\n    JOIN genres g\n    ON g.id = rg.genre_id\n  GROUP BY recordings.id, recordings.recording_title\n) r\n JOIN recording_instrumentations ri\n    ON r.id = ri.recording_id\n    JOIN instrumentations i\n    ON i.id = ri.instrumentation_id\n  GROUP BY r.id, r.recording_title\nORDER BY id\nLIMIT 100\n\n\n\n-- between  50-60ms but but get some 25ms sometimes", error: GroupingError('column "r.genres" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 16: SELECT r.id, r.recording_title, r.genres, STRING_AGG(i.title...\n                                         ^')
2023-01-03 09:31:03,349 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.genres" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 16: SELECT r.id, r.recording_title, r.genres, STRING_AGG(i.title...\n                                         ^\n'
2023-01-03 09:31:03,352 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_instrumentation.sql', error: GroupingError('column "r.genres" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 16: SELECT r.id, r.recording_title, r.genres, STRING_AGG(i.title...\n                                         ^')
2023-01-03 09:31:03,352 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "r.genres" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 16: SELECT r.id, r.recording_title, r.genres, STRING_AGG(i.title...\n                                         ^\n'
2023-01-03 09:43:42,241 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n   HAVING COUNT(*) > 0\n)\n\nSELECT bi.recording_id, bi.inst_count, bg.recording_id, bg.genre_count\nFROM by_instrumentations bi\nOUTER JOIN by_genre bg\nON   bg.recording_id = bi.recording_id', error: SyntaxError('syntax error at or near "OUTER"\nLINE 18: OUTER JOIN by_genre bg\n         ^')
2023-01-03 09:43:42,241 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "OUTER"\nLINE 18: OUTER JOIN by_genre bg\n         ^\n'
2023-01-03 09:43:42,241 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "OUTER"\nLINE 18: OUTER JOIN by_genre bg\n         ^')
2023-01-03 09:43:42,241 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "OUTER"\nLINE 18: OUTER JOIN by_genre bg\n         ^\n'
2023-01-03 09:59:47,768 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n), combined AS {\n\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id),\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n}\n\n\nSELECT * FROM combined', error: SyntaxError('syntax error at or near "{"\nLINE 15: ), combined AS {\n                        ^')
2023-01-03 09:59:47,769 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "{"\nLINE 15: ), combined AS {\n                        ^\n'
2023-01-03 09:59:47,769 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "{"\nLINE 15: ), combined AS {\n                        ^')
2023-01-03 09:59:47,769 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "{"\nLINE 15: ), combined AS {\n                        ^\n'
2023-01-03 10:02:38,524 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n), combined AS (\n\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recoding_id', error: UndefinedColumn('column c.recoding_id does not exist\nLINE 31: ON  r.id = c.recoding_id\n                    ^\nHINT:  Perhaps you meant to reference the column "c.recording_id".')
2023-01-03 10:02:38,524 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column c.recoding_id does not exist\nLINE 31: ON  r.id = c.recoding_id\n                    ^\nHINT:  Perhaps you meant to reference the column "c.recording_id".\n'
2023-01-03 10:02:38,524 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column c.recoding_id does not exist\nLINE 31: ON  r.id = c.recoding_id\n                    ^\nHINT:  Perhaps you meant to reference the column "c.recording_id".')
2023-01-03 10:02:38,524 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column c.recoding_id does not exist\nLINE 31: ON  r.id = c.recoding_id\n                    ^\nHINT:  Perhaps you meant to reference the column "c.recording_id".\n'
2023-01-03 10:20:47,300 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'COUNT (DIST', error: SyntaxError('syntax error at or near "COUNT"\nLINE 1: COUNT (DIST\n        ^')
2023-01-03 10:20:47,300 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "COUNT"\nLINE 1: COUNT (DIST\n        ^\n'
2023-01-03 10:21:23,490 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'COUNT (DISTINCT recording_genres.genre.id)', error: SyntaxError('syntax error at or near "COUNT"\nLINE 1: COUNT (DISTINCT recording_genres.genre.id)\n        ^')
2023-01-03 10:21:23,491 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "COUNT"\nLINE 1: COUNT (DISTINCT recording_genres.genre.id)\n        ^\n'
2023-01-03 10:21:58,934 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT COUNT (DISTINCT recording_genres.genre.id)', error: UndefinedTable('missing FROM-clause entry for table "genre"\nLINE 1: SELECT COUNT (DISTINCT recording_genres.genre.id)\n                               ^')
2023-01-03 10:21:58,934 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "genre"\nLINE 1: SELECT COUNT (DISTINCT recording_genres.genre.id)\n                               ^\n'
2023-01-03 10:22:16,157 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT COUNT (DISTINCT recording_genres.id)', error: UndefinedTable('missing FROM-clause entry for table "recording_genres"\nLINE 1: SELECT COUNT (DISTINCT recording_genres.id)\n                               ^')
2023-01-03 10:22:16,157 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "recording_genres"\nLINE 1: SELECT COUNT (DISTINCT recording_genres.id)\n                               ^\n'
2023-01-03 21:39:00,078 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION\n       query_many_to_many(table_name VARCHAR(100))\nRETURN INT\nAS\n$$\nDECLARE\n-- variables\nBEGIN\n-- logic\n\nEND\n\n\n\nWITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n ), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 500', error: SyntaxError('syntax error at or near "AS"\nLINE 4: AS\n        ^')
2023-01-03 21:39:00,078 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 4: AS\n        ^\n'
2023-01-03 21:39:00,078 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 4: AS\n        ^')
2023-01-03 21:39:00,078 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 4: AS\n        ^\n'
2023-01-03 21:39:25,358 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(table_name int)\nRETURN int\nAS\n$$\nDECLARE\n-- variables\nBEGIN\n-- logic\n\nEND\n\n\n\nWITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n ), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 500', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:39:25,358 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:39:25,358 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:39:25,358 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:41:24,218 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(total_copies int)\nRETURN int\nAS\n$$\nDECLARE\n   copies int;\nBEGIN\n-- logic\n  SELECT COUNT(*) into copies from recordings where total_copies >\nEND;\n$$ language plpgsql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:41:24,218 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:41:24,218 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:41:24,218 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:42:27,918 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURN int\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT COUNT(*) into ids from recordings where ids = id\nEND;\n$$ language plpgsql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:42:27,919 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:42:27,919 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:42:27,919 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:43:39,574 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURN int\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT id into ids from recordings as c where cid = id\n  RETURN ids\nEND;\n$$ language plpgsql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:43:39,574 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:43:39,575 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS\n        ^')
2023-01-03 21:43:39,575 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS\n        ^\n'
2023-01-03 21:43:45,622 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURN int AS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT id into ids from recordings as c where cid = id\n  RETURN ids\nEND;\n$$ language plpgsql', error: SyntaxError('syntax error at or near "AS"\nLINE 2: RETURN int AS\n                   ^')
2023-01-03 21:43:45,622 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 2: RETURN int AS\n                   ^\n'
2023-01-03 21:43:45,622 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 2: RETURN int AS\n                   ^')
2023-01-03 21:43:45,622 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 2: RETURN int AS\n                   ^\n'
2023-01-03 21:44:29,307 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURN int\nAS language plpgsql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS language plpgsql\n        ^')
2023-01-03 21:44:29,307 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS language plpgsql\n        ^\n'
2023-01-03 21:44:29,307 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 3: AS language plpgsql\n        ^')
2023-01-03 21:44:29,307 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 3: AS language plpgsql\n        ^\n'
2023-01-03 21:44:41,293 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURN int\nas language plpgsql', error: SyntaxError('syntax error at or near "as"\nLINE 3: as language plpgsql\n        ^')
2023-01-03 21:44:41,293 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "as"\nLINE 3: as language plpgsql\n        ^\n'
2023-01-03 21:44:41,293 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "as"\nLINE 3: as language plpgsql\n        ^')
2023-01-03 21:44:41,293 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "as"\nLINE 3: as language plpgsql\n        ^\n'
2023-01-03 21:45:10,116 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nAS language plpgsql', error: SyntaxError('syntax error at or near "language"\nLINE 3: AS language plpgsql\n           ^')
2023-01-03 21:45:10,117 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "language"\nLINE 3: AS language plpgsql\n           ^\n'
2023-01-03 21:45:10,117 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "language"\nLINE 3: AS language plpgsql\n           ^')
2023-01-03 21:45:10,117 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "language"\nLINE 3: AS language plpgsql\n           ^\n'
2023-01-03 21:45:20,190 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nAS\nlanguage plpgsql', error: SyntaxError('syntax error at or near "language"\nLINE 4: language plpgsql\n        ^')
2023-01-03 21:45:20,190 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "language"\nLINE 4: language plpgsql\n        ^\n'
2023-01-03 21:45:20,190 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "language"\nLINE 4: language plpgsql\n        ^')
2023-01-03 21:45:20,190 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "language"\nLINE 4: language plpgsql\n        ^\n'
2023-01-03 21:45:34,434 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nlanguage plpgsql\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT id into ids from recordings as c where cid = id\n  RETURN ids\nEND;\n$$', error: SyntaxError('syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^')
2023-01-03 21:45:34,434 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^\n'
2023-01-03 21:45:34,434 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^')
2023-01-03 21:45:34,434 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^\n'
2023-01-03 21:45:41,537 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nlanguage plpgsql\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT id into ids from recordings as c where cid = id\n  RETURNS ids\nEND;\n$$', error: SyntaxError('syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^')
2023-01-03 21:45:41,537 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^\n'
2023-01-03 21:45:41,537 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^')
2023-01-03 21:45:41,537 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^\n'
2023-01-03 21:46:19,395 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nlanguage plpgsql\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT COUNT(id) into ids from recordings as c where c.id = id\n  RETURNS ids\nEND;\n$$', error: SyntaxError('syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^')
2023-01-03 21:46:19,395 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^\n'
2023-01-03 21:46:19,395 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^')
2023-01-03 21:46:19,395 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURNS"\nLINE 11:   RETURNS ids\n           ^\n'
2023-01-03 21:46:25,122 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nlanguage plpgsql\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT COUNT(id) into ids from recordings as c where c.id = id\n  RETURN ids\nEND;\n$$', error: SyntaxError('syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^')
2023-01-03 21:46:25,122 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^\n'
2023-01-03 21:46:25,122 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^')
2023-01-03 21:46:25,122 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "RETURN"\nLINE 11:   RETURN ids\n           ^\n'
2023-01-03 21:46:38,029 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nlanguage plpgsql\nAS\n$$\nDECLARE\n   ids int;\nBEGIN\n-- logic\n  SELECT COUNT(id) into ids from recordings;\n  RETURN ids\nEND;\n$$', error: SyntaxError('syntax error at end of input\nLINE 13: $$\n         ^')
2023-01-03 21:46:38,029 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at end of input\nLINE 13: $$\n         ^\n'
2023-01-03 21:46:38,029 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at end of input\nLINE 13: $$\n         ^')
2023-01-03 21:46:38,029 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at end of input\nLINE 13: $$\n         ^\n'
2023-01-03 21:46:59,981 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(id int)\nRETURNS int\nlanguage plpgsql\nAS\n$$\nDECLARE\n   ids INTEGER;\nBEGIN\n-- logic\n  SELECT COUNT(id) into ids from recordings;\n  RETURN ids\nEND;\n$$', error: SyntaxError('syntax error at end of input\nLINE 13: $$\n         ^')
2023-01-03 21:46:59,981 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at end of input\nLINE 13: $$\n         ^\n'
2023-01-03 21:46:59,981 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at end of input\nLINE 13: $$\n         ^')
2023-01-03 21:46:59,981 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at end of input\nLINE 13: $$\n         ^\n'
2023-01-03 21:47:22,699 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n),by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n ), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 500', error: DuplicateAlias('WITH query name "by_genre" specified more than once\nLINE 15:  ), by_genre AS (\n             ^')
2023-01-03 21:47:22,700 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DuplicateAlias: WITH query name "by_genre" specified more than once\nLINE 15:  ), by_genre AS (\n             ^\n'
2023-01-03 21:47:22,700 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: DuplicateAlias('WITH query name "by_genre" specified more than once\nLINE 15:  ), by_genre AS (\n             ^')
2023-01-03 21:47:22,700 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DuplicateAlias: WITH query name "by_genre" specified more than once\nLINE 15:  ), by_genre AS (\n             ^\n'
2023-01-03 21:48:45,145 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\n--SELECT c.recording_id, r.recording_title FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 500\n\nSELECT query_many_to_many(\n  id := 10\n)', error: AmbiguousColumn('column reference "id" is ambiguous\nLINE 1: SELECT COUNT(id)          from recordings\n                     ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT COUNT(id)          from recordings\nCONTEXT:  PL/pgSQL function query_many_to_many(integer) line 6 at SQL statement')
2023-01-03 21:48:45,145 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.AmbiguousColumn: column reference "id" is ambiguous\nLINE 1: SELECT COUNT(id)          from recordings\n                     ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT COUNT(id)          from recordings\nCONTEXT:  PL/pgSQL function query_many_to_many(integer) line 6 at SQL statement\n'
2023-01-03 21:48:45,145 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: AmbiguousColumn('column reference "id" is ambiguous\nLINE 1: SELECT COUNT(id)          from recordings\n                     ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT COUNT(id)          from recordings\nCONTEXT:  PL/pgSQL function query_many_to_many(integer) line 6 at SQL statement')
2023-01-03 21:48:45,145 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.AmbiguousColumn: column reference "id" is ambiguous\nLINE 1: SELECT COUNT(id)          from recordings\n                     ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT COUNT(id)          from recordings\nCONTEXT:  PL/pgSQL function query_many_to_many(integer) line 6 at SQL statement\n'
2023-01-03 21:55:23,640 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'CREATE OR REPLACE FUNCTION query_many_to_many(table_name VARCHAR(30))\nRETURNS TABLE (\n             recording_id BIGINT,\n             count INT\n               )\nlanguage plpgsql\nAS\n$$\nDECLARE\nBEGIN\n-- logic\n   RETURN (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n  SELECT COUNT(r.id) into ids from recordings AS r;\n  );\nEND;\n$$', error: DatatypeMismatch('RETURN cannot have a parameter in function returning set\nLINE 12:    RETURN (\n                   ^\nHINT:  Use RETURN NEXT or RETURN QUERY.')
2023-01-03 21:55:23,640 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: RETURN cannot have a parameter in function returning set\nLINE 12:    RETURN (\n                   ^\nHINT:  Use RETURN NEXT or RETURN QUERY.\n'
2023-01-03 21:55:23,640 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: DatatypeMismatch('RETURN cannot have a parameter in function returning set\nLINE 12:    RETURN (\n                   ^\nHINT:  Use RETURN NEXT or RETURN QUERY.')
2023-01-03 21:55:23,641 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: RETURN cannot have a parameter in function returning set\nLINE 12:    RETURN (\n                   ^\nHINT:  Use RETURN NEXT or RETURN QUERY.\n'
2023-01-03 21:57:21,661 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\n--SELECT c.recording_id, r.recording_title FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 500\n\nSELECT query_many_to_many()', error: AmbiguousColumn('column reference "recording_id" is ambiguous\nLINE 1: SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n                        ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:57:21,662 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.AmbiguousColumn: column reference "recording_id" is ambiguous\nLINE 1: SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n                        ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:57:21,662 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: AmbiguousColumn('column reference "recording_id" is ambiguous\nLINE 1: SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n                        ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:57:21,662 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.AmbiguousColumn: column reference "recording_id" is ambiguous\nLINE 1: SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n                        ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:57:54,636 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\n--SELECT c.recording_id, r.recording_title FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 500\n\nSELECT query_many_to_many()', error: AmbiguousColumn('column reference "recording_id" is ambiguous\nLINE 4:    GROUP BY recording_id\n                    ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:57:54,636 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.AmbiguousColumn: column reference "recording_id" is ambiguous\nLINE 4:    GROUP BY recording_id\n                    ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:57:54,636 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: AmbiguousColumn('column reference "recording_id" is ambiguous\nLINE 4:    GROUP BY recording_id\n                    ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:57:54,636 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.AmbiguousColumn: column reference "recording_id" is ambiguous\nLINE 4:    GROUP BY recording_id\n                    ^\nDETAIL:  It could refer to either a PL/pgSQL variable or a table column.\nQUERY:  SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\nCONTEXT:  PL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:58:24,390 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\n--SELECT c.recording_id, r.recording_title FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 500\n\nSELECT query_many_to_many()', error: DatatypeMismatch('structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:58:24,391 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:58:24,391 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: DatatypeMismatch('structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:58:24,391 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:58:58,225 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\n--SELECT c.recording_id, r.recording_title FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 500\n\nSELECT query_many_to_many()', error: DatatypeMismatch('structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:58:58,226 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:58:58,226 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: DatatypeMismatch('structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:58:58,226 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:59:26,693 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0) + COALESCE(bg.genre_count, 0) AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON   bg.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n-- finally we join the recordings\n--SELECT c.recording_id, r.recording_title FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 500\n\nSELECT query_many_to_many()', error: DatatypeMismatch('structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 2"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:59:26,693 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 2"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 21:59:26,693 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: DatatypeMismatch('structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 2"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY')
2023-01-03 21:59:26,693 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DatatypeMismatch: structure of query does not match function result type\nDETAIL:  Returned type bigint does not match expected type integer in column 2.\nCONTEXT:  SQL statement "SELECT DISTINCT ri.recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations ri\n   WHERE ri.instrumentation_id = 8 OR ri.instrumentation_id = 31\n   GROUP BY ri.recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 2"\nPL/pgSQL function query_many_to_many() line 5 at RETURN QUERY\n'
2023-01-03 22:04:24,771 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n)\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id, bc.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convetion bc\nON  bc.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 500', error: SyntaxError('syntax error at or near "combined"\nLINE 25: combined AS (\n         ^')
2023-01-03 22:04:24,771 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "combined"\nLINE 25: combined AS (\n         ^\n'
2023-01-03 22:04:24,771 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "combined"\nLINE 25: combined AS (\n         ^')
2023-01-03 22:04:24,772 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "combined"\nLINE 25: combined AS (\n         ^\n'
2023-01-03 22:04:31,030 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT COALESCE(bi.recording_id, bg.recording_id, bc.recording_id) AS recording_id,\n       COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convetion bc\nON  bc.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 500', error: UndefinedTable('relation "by_convetion" does not exist\nLINE 37: FULL JOIN by_convetion bc\n                   ^')
2023-01-03 22:04:31,031 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "by_convetion" does not exist\nLINE 37: FULL JOIN by_convetion bc\n                   ^\n'
2023-01-03 22:04:31,031 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('relation "by_convetion" does not exist\nLINE 37: FULL JOIN by_convetion bc\n                   ^')
2023-01-03 22:04:31,031 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "by_convetion" does not exist\nLINE 37: FULL JOIN by_convetion bc\n                   ^\n'
2023-01-03 22:07:07,728 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'SET STATISTICS IO, TIME ON', error: SyntaxError('syntax error at or near "IO"\nLINE 1: SET STATISTICS IO, TIME ON\n                       ^')
2023-01-03 22:07:07,729 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "IO"\nLINE 1: SET STATISTICS IO, TIME ON\n                       ^\n'
2023-01-03 22:09:42,416 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'ANALYZE SELECT * from recordings', error: SyntaxError('syntax error at or near "SELECT"\nLINE 1: ANALYZE SELECT * from recordings\n                ^')
2023-01-03 22:09:42,417 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 1: ANALYZE SELECT * from recordings\n                ^\n'
2023-01-03 22:10:13,156 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE recordings', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^')
2023-01-03 22:10:13,156 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^\n'
2023-01-03 22:10:28,445 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE recordings', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^')
2023-01-03 22:10:28,445 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^\n'
2023-01-03 22:10:45,409 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) SELECT * FROM recordings ANALYZE', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...BOSE, BUFFERS, FORMAT JSON) SELECT * FROM recordings ANALYZE\n                                                                ^')
2023-01-03 22:10:45,409 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...BOSE, BUFFERS, FORMAT JSON) SELECT * FROM recordings ANALYZE\n                                                                ^\n'
2023-01-03 22:10:53,162 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) (SELECT * FROM recordings) ANALYZE', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...SE, BUFFERS, FORMAT JSON) (SELECT * FROM recordings) ANALYZE\n                                                                ^')
2023-01-03 22:10:53,162 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...SE, BUFFERS, FORMAT JSON) (SELECT * FROM recordings) ANALYZE\n                                                                ^\n'
2023-01-03 22:12:04,168 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE recordings', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^')
2023-01-03 22:12:04,168 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^\n'
2023-01-03 22:12:17,619 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE recordings', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^')
2023-01-03 22:12:17,620 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^\n'
2023-01-03 22:12:31,404 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE recordings (recording_id)', error: SyntaxError('syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^')
2023-01-03 22:12:31,404 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ANALYZE"\nLINE 1: ...N (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) ANALYZE re...\n                                                             ^\n'
2023-01-03 22:12:43,439 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'ANALYZE recordings (recording_id)', error: UndefinedColumn('column "recording_id" of relation "recordings" does not exist')
2023-01-03 22:12:43,439 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "recording_id" of relation "recordings" does not exist\n'
2023-01-03 22:18:05,820 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_convention bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 500', error: UndefinedColumn('column bl.lan_count does not exist\nLINE 41:       + COALESCE(bl.lan_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bl.conv_count".')
2023-01-03 22:18:05,820 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column bl.lan_count does not exist\nLINE 41:       + COALESCE(bl.lan_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bl.conv_count".\n'
2023-01-03 22:18:05,820 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column bl.lan_count does not exist\nLINE 41:       + COALESCE(bl.lan_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bl.conv_count".')
2023-01-03 22:18:05,820 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column bl.lan_count does not exist\nLINE 41:       + COALESCE(bl.lan_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bl.conv_count".\n'
2023-01-03 22:28:38,125 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n, by_vocals AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bc.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0', error: SyntaxError('syntax error at or near ","\nLINE 25: , by_vocals AS (\n         ^')
2023-01-03 22:28:38,126 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ","\nLINE 25: , by_vocals AS (\n         ^\n'
2023-01-03 22:28:38,126 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near ","\nLINE 25: , by_vocals AS (\n         ^')
2023-01-03 22:28:38,126 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ","\nLINE 25: , by_vocals AS (\n         ^\n'
2023-01-03 22:28:48,386 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocals AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bc.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0', error: UndefinedTable('relation "by_vocal" does not exist\nLINE 57: FULL JOIN by_vocal bv\n                   ^')
2023-01-03 22:28:48,386 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "by_vocal" does not exist\nLINE 57: FULL JOIN by_vocal bv\n                   ^\n'
2023-01-03 22:28:48,386 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('relation "by_vocal" does not exist\nLINE 57: FULL JOIN by_vocal bv\n                   ^')
2023-01-03 22:28:48,387 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "by_vocal" does not exist\nLINE 57: FULL JOIN by_vocal bv\n                   ^\n'
2023-01-03 22:28:56,809 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from both\n-- by_instrumentions query and by_genre query\n-- and order them by the most number of matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bc.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0', error: UndefinedColumn('column bc.vocal_count does not exist\nLINE 49:       + COALESCE(bc.vocal_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bv.vocal_count".')
2023-01-03 22:28:56,809 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column bc.vocal_count does not exist\nLINE 49:       + COALESCE(bc.vocal_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bv.vocal_count".\n'
2023-01-03 22:28:56,809 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column bc.vocal_count does not exist\nLINE 49:       + COALESCE(bc.vocal_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bv.vocal_count".')
2023-01-03 22:28:56,809 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column bc.vocal_count does not exist\nLINE 49:       + COALESCE(bc.vocal_count, 0)\n                          ^\nHINT:  Perhaps you meant to reference the column "bv.vocal_count".\n'
2023-01-03 22:38:02,453 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'clear', error: SyntaxError('syntax error at or near "clear"\nLINE 1: clear\n        ^')
2023-01-03 22:38:02,453 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "clear"\nLINE 1: clear\n        ^\n'
2023-01-03 22:39:17,642 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (', error: SyntaxError('syntax error at end of input\nLINE 1: WITH by_instrumentations AS (\n                                     ^')
2023-01-03 22:39:17,643 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at end of input\nLINE 1: WITH by_instrumentations AS (\n                                     ^\n'
2023-01-03 22:39:17,643 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at end of input\nLINE 1: WITH by_instrumentations AS (\n                                     ^')
2023-01-03 22:39:17,643 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at end of input\nLINE 1: WITH by_instrumentations AS (\n                                     ^\n'
2023-01-03 22:44:07,782 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT c.recording_id, r.recording_title, c.total_count, STRING_AGG(v.title, ",") FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nJOIN recording_vocals as rv\nON rv.recording_id = c.recording_id\nJOIN vocals as v\nON r.id = rv.vocal_id\nGROUP BY c.recording_id, r.recording_title, c.total_count\nLIMIT 100\nOFFSET 0', error: UndefinedColumn('column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") FROM ...\n                                                              ^')
2023-01-03 22:44:07,782 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") FROM ...\n                                                              ^\n'
2023-01-03 22:44:07,782 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") FROM ...\n                                                              ^')
2023-01-03 22:44:07,782 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") FROM ...\n                                                              ^\n'
2023-01-03 22:44:58,071 (340147/MainThread) pgcli.pgexecute ERROR - sql: 'WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT c.recording_id, r.recording_title, c.total_count, STRING_AGG(v.title, ",") AS vocals\nFROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nJOIN recording_vocals as rv\nON rv.recording_id = c.recording_id\nJOIN vocals as v\nON r.id = rv.vocal_id\nGROUP BY c.recording_id, r.recording_title, c.total_count\nLIMIT 100\nOFFSET 0', error: UndefinedColumn('column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") AS vo...\n                                                              ^')
2023-01-03 22:44:58,071 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") AS vo...\n                                                              ^\n'
2023-01-03 22:44:58,071 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") AS vo...\n                                                              ^')
2023-01-03 22:44:58,071 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "," does not exist\nLINE 74: ...cording_title, c.total_count, STRING_AGG(v.title, ",") AS vo...\n                                                              ^\n'
2023-01-03 22:48:30,872 (340147/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT c.recording_id, r.recording_title, c.total_count, STRING_AGG(rv.recording_id, ',') AS vocals\nFROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nJOIN recording_vocals as rv\nON rv.recording_id = c.recording_id\nGROUP BY c.recording_id, r.recording_title, c.total_count", error: UndefinedFunction('function string_agg(bigint, unknown) does not exist\nLINE 74: ...c.recording_id, r.recording_title, c.total_count, STRING_AGG...\n                                                              ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.')
2023-01-03 22:48:30,872 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function string_agg(bigint, unknown) does not exist\nLINE 74: ...c.recording_id, r.recording_title, c.total_count, STRING_AGG...\n                                                              ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 22:48:30,872 (340147/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedFunction('function string_agg(bigint, unknown) does not exist\nLINE 74: ...c.recording_id, r.recording_title, c.total_count, STRING_AGG...\n                                                              ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.')
2023-01-03 22:48:30,872 (340147/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedFunction: function string_agg(bigint, unknown) does not exist\nLINE 74: ...c.recording_id, r.recording_title, c.total_count, STRING_AGG...\n                                                              ^\nHINT:  No function matches the given name and argument types. You might need to add explicit type casts.\n'
2023-01-03 22:49:17,418 (357138/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2023-01-03 22:49:17,418 (357138/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
2023-01-03 22:58:10,329 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT r.recording_id, r.recording_title, STRING_AGG(v.title, ',') FROM (\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0\n) AS r\nLEFT JOIN recording_vocals AS rv\nON rv.recording_id = r.recording_id\nLEFT JOIN vocals AS v\nON v.id = r.vocals_id\nGROUP BY r.recording_title, r.recording_id", error: UndefinedColumn('column r.vocals_id does not exist\nLINE 84: ON v.id = r.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".')
2023-01-03 22:58:10,330 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column r.vocals_id does not exist\nLINE 84: ON v.id = r.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".\n'
2023-01-03 22:58:10,330 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column r.vocals_id does not exist\nLINE 84: ON v.id = r.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".')
2023-01-03 22:58:10,330 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column r.vocals_id does not exist\nLINE 84: ON v.id = r.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".\n'
2023-01-03 22:58:18,233 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT r.recording_id, r.recording_title, STRING_AGG(v.title, ',') FROM (\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0\n) AS r\nLEFT JOIN recording_vocals AS rv\nON rv.recording_id = r.recording_id\nLEFT JOIN vocals AS v\nON v.id = rv.vocals_id\nGROUP BY r.recording_title, r.recording_id", error: UndefinedColumn('column rv.vocals_id does not exist\nLINE 84: ON v.id = rv.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".')
2023-01-03 22:58:18,233 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column rv.vocals_id does not exist\nLINE 84: ON v.id = rv.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".\n'
2023-01-03 22:58:18,233 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column rv.vocals_id does not exist\nLINE 84: ON v.id = rv.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".')
2023-01-03 22:58:18,233 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column rv.vocals_id does not exist\nLINE 84: ON v.id = rv.vocals_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".\n'
2023-01-03 23:01:15,878 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' '), COALESCE(STRING_AGG(i.title, ','), ' ') FROM (\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0\n) AS r\nLEFT JOIN recording_vocals AS rv\nON rv.recording_id = r.recording_id\nLEFT JOIN vocals AS v\nON v.id = rv.vocal_id\nLEFT JOIN recording_intrumentations AS ri\nON ri.recording_id = r.recording_id\nLEFT JOIN instrumentations AS i\nON i.id = ri.vocal_id\nGROUP BY r.recording_title, r.recording_id, r.total_count\nORDER BY total_count DESC", error: UndefinedTable('relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^')
2023-01-03 23:01:15,878 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^\n'
2023-01-03 23:01:15,882 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^')
2023-01-03 23:01:15,882 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^\n'
2023-01-03 23:01:31,425 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' '), COALESCE(STRING_AGG(i.title, ','), ' ') FROM (\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0\n) AS r\nLEFT JOIN recording_vocals AS rv\nON rv.recording_id = r.recording_id\nLEFT JOIN vocals AS v\nON v.id = rv.vocal_id\nLEFT JOIN recording_instrumentations AS ri\nON ri.recording_id = r.recording_id\nLEFT JOIN instrumentations AS i\nON i.id = ri.vocal_id\nGROUP BY r.recording_title, r.recording_id, r.total_count\nORDER BY total_count DESC", error: UndefinedColumn('column ri.vocal_id does not exist\nLINE 88: ON i.id = ri.vocal_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".')
2023-01-03 23:01:31,425 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column ri.vocal_id does not exist\nLINE 88: ON i.id = ri.vocal_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".\n'
2023-01-03 23:01:31,425 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column ri.vocal_id does not exist\nLINE 88: ON i.id = ri.vocal_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".')
2023-01-03 23:01:31,425 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column ri.vocal_id does not exist\nLINE 88: ON i.id = ri.vocal_id\n                   ^\nHINT:  Perhaps you meant to reference the column "rv.vocal_id".\n'
2023-01-03 23:04:08,329 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n--SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n--JOIN recordings r\n--ON  r.id = c.recording_id\n--LIMIT 100\n--OFFSET 0\n\n-- query joining just to check returns\n\nSELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0\n) AS r\nLEFT JOIN recording_vocals AS rv\nON rv.recording_id = r.recording_id\nLEFT JOIN vocals AS v\nON v.id = rv.vocal_id\nLEFT JOIN recording_intrumentations AS ri\nON rv.recording_id = r.recording_id\nLEFT JOIN vocals AS v\nON v.id = rv.vocal_id\n\nGROUP BY r.recording_title, r.recording_id, r.total_count\nORDER BY total_count DESC", error: UndefinedTable('relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^')
2023-01-03 23:04:08,329 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^\n'
2023-01-03 23:04:08,329 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^')
2023-01-03 23:04:08,330 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "recording_intrumentations" does not exist\nLINE 85: LEFT JOIN recording_intrumentations AS ri\n                   ^\n'
2023-01-03 23:05:05,038 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'ls', error: SyntaxError('syntax error at or near "ls"\nLINE 1: ls\n        ^')
2023-01-03 23:05:05,038 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "ls"\nLINE 1: ls\n        ^\n'
2023-01-03 23:06:04,809 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nJOIN cues AS c\nON c.id =  r.cue_id\nLIMIT 100\nOFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: DuplicateAlias('table name "c" specified more than once')
2023-01-03 23:06:04,809 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DuplicateAlias: table name "c" specified more than once\n'
2023-01-03 23:06:04,809 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: DuplicateAlias('table name "c" specified more than once')
2023-01-03 23:06:04,809 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.DuplicateAlias: table name "c" specified more than once\n'
2023-01-04 07:50:34,917 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- relationship between them is OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count, cue.title FROM combined c\nJOIN recordings r\nON  r.id = c.recording_id\nLIMIT 100\nOFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedTable('missing FROM-clause entry for table "cue"\nLINE 66: ...c.recording_id, r.recording_title, c.total_count, cue.title ...\n                                                              ^')
2023-01-04 07:50:34,917 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "cue"\nLINE 66: ...c.recording_id, r.recording_title, c.total_count, cue.title ...\n                                                              ^\n'
2023-01-04 07:50:34,917 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('missing FROM-clause entry for table "cue"\nLINE 66: ...c.recording_id, r.recording_title, c.total_count, cue.title ...\n                                                              ^')
2023-01-04 07:50:34,917 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "cue"\nLINE 66: ...c.recording_id, r.recording_title, c.total_count, cue.title ...\n                                                              ^\n'
2023-01-04 08:02:06,038 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count + 1 FILTER (WHERE cue.id = 1), cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "FILTER"\nLINE 66: ...ecording_id, r.recording_title, c.total_count + 1 FILTER (WH...\n                                                              ^')
2023-01-04 08:02:06,038 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FILTER"\nLINE 66: ...ecording_id, r.recording_title, c.total_count + 1 FILTER (WH...\n                                                              ^\n'
2023-01-04 08:02:06,038 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "FILTER"\nLINE 66: ...ecording_id, r.recording_title, c.total_count + 1 FILTER (WH...\n                                                              ^')
2023-01-04 08:02:06,038 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FILTER"\nLINE 66: ...ecording_id, r.recording_title, c.total_count + 1 FILTER (WH...\n                                                              ^\n'
2023-01-04 08:02:50,513 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count, COUNT(1) FILTER (WHERE cue.id = 1), cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^')
2023-01-04 08:02:50,513 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^\n'
2023-01-04 08:02:50,513 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^')
2023-01-04 08:02:50,513 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^\n'
2023-01-04 08:03:10,558 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id, r.recording_title, c.total_count, COUNT(1) FILTER (WHERE cue.id = 1) AS F, cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^')
2023-01-04 08:03:10,558 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^\n'
2023-01-04 08:03:10,558 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^')
2023-01-04 08:03:10,559 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id, r.recording_title, c.total_count, COU...\n                ^\n'
2023-01-04 08:04:33,401 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(1) OVER FILTER (WHERE cue.id = 1) AS F,\n       cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "("\nLINE 69:        COUNT(1) OVER FILTER (WHERE cue.id = 1) AS F,\n                                     ^')
2023-01-04 08:04:33,401 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "("\nLINE 69:        COUNT(1) OVER FILTER (WHERE cue.id = 1) AS F,\n                                     ^\n'
2023-01-04 08:04:33,401 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "("\nLINE 69:        COUNT(1) OVER FILTER (WHERE cue.id = 1) AS F,\n                                     ^')
2023-01-04 08:04:33,401 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "("\nLINE 69:        COUNT(1) OVER FILTER (WHERE cue.id = 1) AS F,\n                                     ^\n'
2023-01-04 08:11:52,193 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(CASE WHEN cue.id = 5 THEN 1 ELSE 0 END ) OVER (PARTITION BY cue.id) AS CUE COUNT ,\n       cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "COUNT"\nLINE 69: ...HEN 1 ELSE 0 END ) OVER (PARTITION BY cue.id) AS CUE COUNT ,\n                                                                 ^')
2023-01-04 08:11:52,193 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "COUNT"\nLINE 69: ...HEN 1 ELSE 0 END ) OVER (PARTITION BY cue.id) AS CUE COUNT ,\n                                                                 ^\n'
2023-01-04 08:11:52,193 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "COUNT"\nLINE 69: ...HEN 1 ELSE 0 END ) OVER (PARTITION BY cue.id) AS CUE COUNT ,\n                                                                 ^')
2023-01-04 08:11:52,193 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "COUNT"\nLINE 69: ...HEN 1 ELSE 0 END ) OVER (PARTITION BY cue.id) AS CUE COUNT ,\n                                                                 ^\n'
2023-01-04 08:12:46,519 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(CASE WHEN cue.id = 5 THEN 1 ELSE 0 END ) AS cue_count ,\n       cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id,\n                ^')
2023-01-04 08:12:46,519 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id,\n                ^\n'
2023-01-04 08:12:46,519 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id,\n                ^')
2023-01-04 08:12:46,520 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.recording_id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 66: SELECT c.recording_id,\n                ^\n'
2023-01-04 08:13:51,282 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(CASE WHEN cue.id = 5 THEN 1 ELSE 0 END ) AS cue_count ,\n       cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  ORDER BY total_count DESC\n  GROUP BY c.recording_id, r.recording_title, c.total_count\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "GROUP"\nLINE 77:   GROUP BY c.recording_id, r.recording_title, c.total_count\n           ^')
2023-01-04 08:13:51,282 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "GROUP"\nLINE 77:   GROUP BY c.recording_id, r.recording_title, c.total_count\n           ^\n'
2023-01-04 08:13:51,283 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "GROUP"\nLINE 77:   GROUP BY c.recording_id, r.recording_title, c.total_count\n           ^')
2023-01-04 08:13:51,283 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "GROUP"\nLINE 77:   GROUP BY c.recording_id, r.recording_title, c.total_count\n           ^\n'
2023-01-04 08:13:59,892 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(CASE WHEN cue.id = 5 THEN 1 ELSE 0 END ) AS cue_count ,\n       cue.title\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "cue.title" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 70:        cue.title\n                ^')
2023-01-04 08:13:59,892 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "cue.title" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 70:        cue.title\n                ^\n'
2023-01-04 08:13:59,892 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "cue.title" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 70:        cue.title\n                ^')
2023-01-04 08:13:59,892 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "cue.title" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 70:        cue.title\n                ^\n'
2023-01-04 08:14:58,307 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(CASE WHEN cue.id = 1 THEN 1 ELSE 0 END ) AS cue_count,\n       cue.title\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count, c.title\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedColumn('column c.title does not exist\nLINE 77: ...BY c.recording_id, r.recording_title, c.total_count, c.title\n                                                                 ^\nHINT:  Perhaps you meant to reference the column "cue.title".')
2023-01-04 08:14:58,307 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column c.title does not exist\nLINE 77: ...BY c.recording_id, r.recording_title, c.total_count, c.title\n                                                                 ^\nHINT:  Perhaps you meant to reference the column "cue.title".\n'
2023-01-04 08:14:58,307 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column c.title does not exist\nLINE 77: ...BY c.recording_id, r.recording_title, c.total_count, c.title\n                                                                 ^\nHINT:  Perhaps you meant to reference the column "cue.title".')
2023-01-04 08:14:58,307 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column c.title does not exist\nLINE 77: ...BY c.recording_id, r.recording_title, c.total_count, c.title\n                                                                 ^\nHINT:  Perhaps you meant to reference the column "cue.title".\n'
2023-01-04 08:18:07,084 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       c.total_count,\n       COUNT(1) + c.total_count FILTER (WHERE cue.id = 1) AS cue_count,\n       cue.id\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count, cue.id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "FILTER"\nLINE 69:        COUNT(1) + c.total_count FILTER (WHERE cue.id = 1) AS...\n                                         ^')
2023-01-04 08:18:07,084 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FILTER"\nLINE 69:        COUNT(1) + c.total_count FILTER (WHERE cue.id = 1) AS...\n                                         ^\n'
2023-01-04 08:18:07,084 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "FILTER"\nLINE 69:        COUNT(1) + c.total_count FILTER (WHERE cue.id = 1) AS...\n                                         ^')
2023-01-04 08:18:07,084 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FILTER"\nLINE 69:        COUNT(1) + c.total_count FILTER (WHERE cue.id = 1) AS...\n                                         ^\n'
2023-01-04 08:18:59,677 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS total_count,\n       cue.id\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  GROUP BY c.recording_id, r.recording_title, cue.id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^')
2023-01-04 08:18:59,678 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^\n'
2023-01-04 08:18:59,678 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^')
2023-01-04 08:18:59,678 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^\n'
2023-01-04 08:19:37,077 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n),\ncombined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\nSELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS match_count,\n       cue.id\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  GROUP BY c.recording_id, r.recording_title, cue.id\n  ORDER BY match_count DESC\n  LIMIT 100\n  OFFSET 0\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^')
2023-01-04 08:19:37,078 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^\n'
2023-01-04 08:19:37,078 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^')
2023-01-04 08:19:37,078 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "c.total_count" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 68:        COUNT(1) FILTER (WHERE cue.id = 1) + c.total_count AS...\n                                                     ^\n'
2023-01-04 08:27:11,943 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n -- we use aggregation here to count the matches for 1 to many relations\nSELECT c.recording_id,\n       r.recording_title,\n       -- counts +1 to total_cout when condition matches\n       COUNT(1) FILTER (WHERE cue.id = 4) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS key_sig_count,\n       c.total_count + cue_count + key_sig_count AS total_count\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  JOIN key_signatures  ks\n  ON ks.id = r.key_signature_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedColumn('column "cue_count" does not exist\nLINE 72:        c.total_count + cue_count + key_sig_count AS total_co...\n                                ^')
2023-01-04 08:27:11,943 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "cue_count" does not exist\nLINE 72:        c.total_count + cue_count + key_sig_count AS total_co...\n                                ^\n'
2023-01-04 08:27:11,943 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column "cue_count" does not exist\nLINE 72:        c.total_count + cue_count + key_sig_count AS total_co...\n                                ^')
2023-01-04 08:27:11,943 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "cue_count" does not exist\nLINE 72:        c.total_count + cue_count + key_sig_count AS total_co...\n                                ^\n'
2023-01-04 08:31:18,688 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n -- we use aggregation here to count the matches for 1 to many relations\nSELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) as cue_count,\n       -- counts +1 to total_cout when condition matches\n     -- COUNT(1) FILTER (WHERE cue.id = 1) +\n     -- COUNT(1) FILTER (WHERE ks.id = 1)\n     -- AS total_count\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  JOIN key_signatures  ks\n  ON ks.id = r.key_signature_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count, ks.id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^')
2023-01-04 08:31:18,688 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^\n'
2023-01-04 08:31:18,688 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^')
2023-01-04 08:31:18,688 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^\n'
2023-01-04 08:31:21,257 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n -- we use aggregation here to count the matches for 1 to many relations\nSELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) as cue_count,\n       -- counts +1 to total_cout when condition matches\n     -- COUNT(1) FILTER (WHERE cue.id = 1) +\n     -- COUNT(1) FILTER (WHERE ks.id = 1)\n     -- AS total_count\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  JOIN key_signatures  ks\n  ON ks.id = r.key_signature_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count, ks.id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^')
2023-01-04 08:31:21,257 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^\n'
2023-01-04 08:31:21,257 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^')
2023-01-04 08:31:21,257 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FROM"\nLINE 76: FROM combined c\n         ^\n'
2023-01-04 08:34:04,173 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n -- we use aggregation here to count the matches for 1 to many relations\nSELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) as cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) as ks_count,\n       AS total_count\n\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  JOIN key_signatures  ks\n  ON ks.id = r.key_signature_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count, ks.id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "AS"\nLINE 72:        AS total_count\n                ^')
2023-01-04 08:34:04,173 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 72:        AS total_count\n                ^\n'
2023-01-04 08:34:04,173 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "AS"\nLINE 72:        AS total_count\n                ^')
2023-01-04 08:34:04,173 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "AS"\nLINE 72:        AS total_count\n                ^\n'
2023-01-04 08:34:44,242 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n\n -- finally we join the recordings\n -- we use aggregation here to count the matches for 1 to many relations\nSELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) as cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) as ks_count,\n       c.total_count,\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  JOIN key_signatures  ks\n  ON ks.id = r.key_signature_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count, ks.id\n  ORDER BY total_count DESC\n  LIMIT 100\n  OFFSET 0\n\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "FROM"\nLINE 73: FROM combined c\n         ^')
2023-01-04 08:34:44,242 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FROM"\nLINE 73: FROM combined c\n         ^\n'
2023-01-04 08:34:44,242 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "FROM"\nLINE 73: FROM combined c\n         ^')
2023-01-04 08:34:44,242 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "FROM"\nLINE 73: FROM combined c\n         ^\n'
2023-01-04 08:38:33,591 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n), final (\n\n -- we use aggregation here to count the matches for 1 to many relations\nSELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       c.total_count\nFROM combined c\n  JOIN recordings r\n  ON  r.id = c.recording_id\n  JOIN cues AS cue\n  ON cue.id = r.cue_id\n  JOIN key_signatures  ks\n  ON ks.id = r.key_signature_id\n  GROUP BY c.recording_id, r.recording_title, c.total_count\n)\n\n -- finally we join the recordings\n\n  SELECT f.recording_id, f.recording_title, f.total_count\n  FROM final\n  ORDER BY total_count\n  LIMIT 100\n  OFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "SELECT"\nLINE 66: SELECT c.recording_id,\n         ^')
2023-01-04 08:38:33,592 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 66: SELECT c.recording_id,\n         ^\n'
2023-01-04 08:38:33,592 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "SELECT"\nLINE 66: SELECT c.recording_id,\n         ^')
2023-01-04 08:38:33,592 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 66: SELECT c.recording_id,\n         ^\n'
2023-01-04 08:40:09,068 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n), final (\n\n -- we use aggregation here to count the matches for 1 to many relations\n)\n\n -- finally we join the recordings\n\nSELECT f.recording_id, f.recording_title, f.total_count\nFROM  (SELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       c.total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n        GROUP BY c.recording_id, r.recording_title, c.total_count)\n\nORDER BY total_count\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near ")"\nLINE 66: )\n         ^')
2023-01-04 08:40:09,068 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ")"\nLINE 66: )\n         ^\n'
2023-01-04 08:40:09,068 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near ")"\nLINE 66: )\n         ^')
2023-01-04 08:40:09,068 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ")"\nLINE 66: )\n         ^\n'
2023-01-04 08:40:33,281 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n), final (\n\n -- we use aggregation here to count the matches for 1 to many relations\n)\n\n -- finally we join the recordings\n\nSELECT f.recording_id, f.recording_title, f.total_count\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       c.total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n\nORDER BY total_count\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near ")"\nLINE 66: )\n         ^')
2023-01-04 08:40:33,282 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ")"\nLINE 66: )\n         ^\n'
2023-01-04 08:40:33,282 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near ")"\nLINE 66: )\n         ^')
2023-01-04 08:40:33,282 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near ")"\nLINE 66: )\n         ^\n'
2023-01-04 08:40:46,228 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n -- finally we join the recordings\n\nSELECT f.recording_id, f.recording_title, f.total_count\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       c.total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n\nORDER BY total_count\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('subquery in FROM must have an alias\nLINE 67: FROM  ( SELECT c.recording_id,\n               ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.')
2023-01-04 08:40:46,228 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: subquery in FROM must have an alias\nLINE 67: FROM  ( SELECT c.recording_id,\n               ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.\n'
2023-01-04 08:40:46,228 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('subquery in FROM must have an alias\nLINE 67: FROM  ( SELECT c.recording_id,\n               ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.')
2023-01-04 08:40:46,228 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: subquery in FROM must have an alias\nLINE 67: FROM  ( SELECT c.recording_id,\n               ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.\n'
2023-01-04 08:41:05,229 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n      + COALESCE(bg.genre_count, 0)\n      + COALESCE(bc.conv_count, 0)\n      + COALESCE(bv.vocal_count, 0)\n      + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\nORDER BY total_count DESC\n)\n -- finally we join the recordings\n\nSELECT f.recording_id, f.recording_title, f.total_count\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       ks.id,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       c.total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: GroupingError('column "ks.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 69:        ks.id,\n                ^')
2023-01-04 08:41:05,229 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "ks.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 69:        ks.id,\n                ^\n'
2023-01-04 08:41:05,229 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: GroupingError('column "ks.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 69:        ks.id,\n                ^')
2023-01-04 08:41:05,230 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.GroupingError: column "ks.id" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 69:        ks.id,\n                ^\n'
2023-01-04 08:49:22,662 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE m.id = 1) AS meter_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meter m\n        ON m.id = r.meter_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedTable('relation "meter" does not exist\nLINE 88:         JOIN meter m\n                      ^')
2023-01-04 08:49:22,662 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "meter" does not exist\nLINE 88:         JOIN meter m\n                      ^\n'
2023-01-04 08:49:22,662 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('relation "meter" does not exist\nLINE 88:         JOIN meter m\n                      ^')
2023-01-04 08:49:22,663 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "meter" does not exist\nLINE 88:         JOIN meter m\n                      ^\n'
2023-01-04 08:49:51,598 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE meter.id = 1) AS meter_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meter meter\n        ON meter.id = r.meter_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedTable('relation "meter" does not exist\nLINE 90:         JOIN meter meter\n                      ^')
2023-01-04 08:49:51,599 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "meter" does not exist\nLINE 90:         JOIN meter meter\n                      ^\n'
2023-01-04 08:49:51,599 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('relation "meter" does not exist\nLINE 90:         JOIN meter meter\n                      ^')
2023-01-04 08:49:51,599 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: relation "meter" does not exist\nLINE 90:         JOIN meter meter\n                      ^\n'
2023-01-04 08:53:21,081 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'select * from recordings where recording_id = 36605', error: UndefinedColumn('column "recording_id" does not exist\nLINE 1: select * from recordings where recording_id = 36605\n                                       ^')
2023-01-04 08:53:21,081 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "recording_id" does not exist\nLINE 1: select * from recordings where recording_id = 36605\n                                       ^\n'
2023-01-04 08:53:39,513 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'select title, shape_id from recordings where id = 36605', error: UndefinedColumn('column "title" does not exist\nLINE 1: select title, shape_id from recordings where id = 36605\n               ^')
2023-01-04 08:53:39,513 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "title" does not exist\nLINE 1: select title, shape_id from recordings where id = 36605\n               ^\n'
2023-01-04 08:55:39,868 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       + f.shape_count\n       + f.tonal_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE meter.id = 1) AS meter_count,\n       COUNT(1) FILTER (WHERE shape.id = 5) AS shape_count,\n       COUNT(1) FILTER (WHERE total.id = 5) AS tonal_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meters meter\n        ON meter.id = r.meter_id\n\n        JOIN shapes shape\n        ON shape.id = r.shape_id\n\n        JOIN shapes tonalities tonal\n        ON tonal.id = r.tonality_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "tonal"\nLINE 100:         JOIN shapes tonalities tonal\n                                         ^')
2023-01-04 08:55:39,868 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "tonal"\nLINE 100:         JOIN shapes tonalities tonal\n                                         ^\n'
2023-01-04 08:55:39,868 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "tonal"\nLINE 100:         JOIN shapes tonalities tonal\n                                         ^')
2023-01-04 08:55:39,868 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "tonal"\nLINE 100:         JOIN shapes tonalities tonal\n                                         ^\n'
2023-01-04 08:56:05,336 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       + f.shape_count\n       + f.tonal_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE meter.id = 1) AS meter_count,\n       COUNT(1) FILTER (WHERE shape.id = 5) AS shape_count,\n       COUNT(1) FILTER (WHERE totality.id = 5) AS tonality_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meters meter\n        ON meter.id = r.meter_id\n\n        JOIN shapes shape\n        ON shape.id = r.shape_id\n\n        JOIN shapes tonalities tonality\n        ON tonality.id = r.tonality_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: SyntaxError('syntax error at or near "tonality"\nLINE 100:         JOIN shapes tonalities tonality\n                                         ^')
2023-01-04 08:56:05,336 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "tonality"\nLINE 100:         JOIN shapes tonalities tonality\n                                         ^\n'
2023-01-04 08:56:05,336 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: SyntaxError('syntax error at or near "tonality"\nLINE 100:         JOIN shapes tonalities tonality\n                                         ^')
2023-01-04 08:56:05,336 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "tonality"\nLINE 100:         JOIN shapes tonalities tonality\n                                         ^\n'
2023-01-04 08:56:16,735 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       + f.shape_count\n       + f.tonal_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE meter.id = 1) AS meter_count,\n       COUNT(1) FILTER (WHERE shape.id = 5) AS shape_count,\n       COUNT(1) FILTER (WHERE totality.id = 5) AS tonality_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meters meter\n        ON meter.id = r.meter_id\n\n        JOIN shapes shape\n        ON shape.id = r.shape_id\n\n        JOIN tonalities tonality\n        ON tonality.id = r.tonality_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedTable('missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 5) AS tonality_c...\n                                       ^')
2023-01-04 08:56:16,735 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 5) AS tonality_c...\n                                       ^\n'
2023-01-04 08:56:16,735 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 5) AS tonality_c...\n                                       ^')
2023-01-04 08:56:16,735 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 5) AS tonality_c...\n                                       ^\n'
2023-01-04 08:56:41,829 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       + f.shape_count\n       + f.tonal_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE meter.id = 1) AS meter_count,\n       COUNT(1) FILTER (WHERE shape.id = 5) AS shape_count,\n       COUNT(1) FILTER (WHERE totality.id = 1) AS tonality_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meters meter\n        ON meter.id = r.meter_id\n\n        JOIN shapes shape\n        ON shape.id = r.shape_id\n\n        JOIN tonalities tonality\n        ON tonality.id = r.tonality_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedTable('missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 1) AS tonality_c...\n                                       ^')
2023-01-04 08:56:41,829 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 1) AS tonality_c...\n                                       ^\n'
2023-01-04 08:56:41,829 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedTable('missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 1) AS tonality_c...\n                                       ^')
2023-01-04 08:56:41,829 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedTable: missing FROM-clause entry for table "totality"\nLINE 81:        COUNT(1) FILTER (WHERE totality.id = 1) AS tonality_c...\n                                       ^\n'
2023-01-04 08:57:04,989 (357138/MainThread) pgcli.pgexecute ERROR - sql: "WITH by_instrumentations AS (\n   SELECT DISTINCT recording_id, COUNT(*) AS inst_count\n   FROM recording_instrumentations\n   WHERE instrumentation_id = 8 OR instrumentation_id = 31\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 1\n\n), by_genre AS (\n   SELECT DISTINCT recording_id, COUNT(*) as genre_count\n   FROM recording_genres\n   WHERE genre_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_convention AS (\n   SELECT DISTINCT recording_id, COUNT(*) as conv_count\n   FROM recording_conventions\n   WHERE convention_id = 6\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_vocal AS (\n   SELECT DISTINCT recording_id, COUNT(*) as vocal_count\n   FROM recording_vocals\n   WHERE vocal_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), by_language AS (\n   SELECT DISTINCT recording_id, COUNT(*) as lan_count\n   FROM recording_languages\n   WHERE language_id = 1\n   GROUP BY recording_id\n  -- count here must match the number of OR clauses\n   HAVING COUNT(*) > 0\n\n), combined AS (\n-- this query will grab results from all WITH clauses\n-- by_instrumentations, by_genre, by_convetion, by_vocal and by_language\n-- the full join merges the queries as an OR\n-- however, this query ORDER BY by the number of most matches\nSELECT  COALESCE(bi.recording_id, bg.recording_id, bc.recording_id, bv.recording_id, bl.recording_id) AS recording_id,\n        COALESCE(bi.inst_count, 0)\n        + COALESCE(bg.genre_count, 0)\n        + COALESCE(bc.conv_count, 0)\n        + COALESCE(bv.vocal_count, 0)\n        + COALESCE(bl.lan_count, 0)\n      AS total_count\nFROM by_instrumentations bi\nFULL JOIN by_genre bg\nON  bg.recording_id = bi.recording_id\nFULL JOIN by_convention bc\nON  bc.recording_id = bi.recording_id\nFULL JOIN by_vocal bv\nON  bv.recording_id = bi.recording_id\nFULL JOIN by_language bl\nON  bl.recording_id = bi.recording_id\n)\n -- finally we join the recordings\n\nSELECT f.recording_id,\n       f.recording_title,\n       f.total_count\n       + f.cue_count\n       + f.keysig_count\n       + f.meter_count\n       + f.shape_count\n       + f.tonal_count\n       AS match_count\n\nFROM  ( SELECT c.recording_id,\n       r.recording_title,\n       COUNT(1) FILTER (WHERE cue.id = 1) AS cue_count,\n       COUNT(1) FILTER (WHERE ks.id = 1) AS keysig_count,\n       COUNT(1) FILTER (WHERE meter.id = 1) AS meter_count,\n       COUNT(1) FILTER (WHERE shape.id = 5) AS shape_count,\n       COUNT(1) FILTER (WHERE t.id = 1) AS tonality_count,\n       c.total_count AS total_count\n\n      FROM combined c\n        JOIN recordings r\n        ON  r.id = c.recording_id\n\n        JOIN cues AS cue\n        ON cue.id = r.cue_id\n\n        JOIN key_signatures  ks\n        ON ks.id = r.key_signature_id\n\n        JOIN meters meter\n        ON meter.id = r.meter_id\n\n        JOIN shapes shape\n        ON shape.id = r.shape_id\n\n        JOIN tonalities t\n        ON t.id = r.tonality_id\n\n        GROUP BY c.recording_id, r.recording_title, c.total_count )\n        AS f\n\nORDER BY total_count DESC\nLIMIT 100\nOFFSET 0\n\n\n-- query joining just to check returns\n\n-- SELECT r.recording_id, r.recording_title, r.total_count, COALESCE(STRING_AGG(v.title, ','), ' ') FROM (\n-- SELECT c.recording_id, r.recording_title, c.total_count FROM combined c\n-- JOIN recordings r\n-- ON  r.id = c.recording_id\n-- LIMIT 100\n-- OFFSET 0\n-- ) AS r\n-- LEFT JOIN recording_vocals AS rv\n-- ON rv.recording_id = r.recording_id\n-- LEFT JOIN vocals AS v\n-- ON v.id = rv.vocal_id\n-- GROUP BY r.recording_title, r.recording_id, r.total_count\n-- ORDER BY total_count DESC", error: UndefinedColumn('column f.tonal_count does not exist\nLINE 72:        + f.tonal_count\n                  ^\nHINT:  Perhaps you meant to reference the column "f.total_count".')
2023-01-04 08:57:04,989 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column f.tonal_count does not exist\nLINE 72:        + f.tonal_count\n                  ^\nHINT:  Perhaps you meant to reference the column "f.total_count".\n'
2023-01-04 08:57:04,989 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/filter_many.sql', error: UndefinedColumn('column f.tonal_count does not exist\nLINE 72:        + f.tonal_count\n                  ^\nHINT:  Perhaps you meant to reference the column "f.total_count".')
2023-01-04 08:57:04,989 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column f.tonal_count does not exist\nLINE 72:        + f.tonal_count\n                  ^\nHINT:  Perhaps you meant to reference the column "f.total_count".\n'
2023-01-04 09:23:49,159 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'select * recording_moods', error: SyntaxError('syntax error at or near "recording_moods"\nLINE 1: select * recording_moods\n                 ^')
2023-01-04 09:23:49,160 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "recording_moods"\nLINE 1: select * recording_moods\n                 ^\n'
2023-01-04 09:24:00,559 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'select moods from recordings', error: UndefinedColumn('column "moods" does not exist\nLINE 1: select moods from recordings\n               ^')
2023-01-04 09:24:00,560 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "moods" does not exist\nLINE 1: select moods from recordings\n               ^\n'
2023-01-04 09:44:25,130 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'sqrt(24)', error: SyntaxError('syntax error at or near "sqrt"\nLINE 1: sqrt(24)\n        ^')
2023-01-04 09:44:25,130 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "sqrt"\nLINE 1: sqrt(24)\n        ^\n'
2023-01-04 09:50:33,212 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree,\ndistance,\nrecording_id\ndistance + 20 - 2 * distance * 20 *\n   SELECT ABS(degree - 10)\n     AS eucledian_distance\nFROM moods', error: SyntaxError('syntax error at or near "+"\nLINE 4: distance + 20 - 2 * distance * 20 *\n                 ^')
2023-01-04 09:50:33,212 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "+"\nLINE 4: distance + 20 - 2 * distance * 20 *\n                 ^\n'
2023-01-04 09:50:33,215 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: SyntaxError('syntax error at or near "+"\nLINE 4: distance + 20 - 2 * distance * 20 *\n                 ^')
2023-01-04 09:50:33,215 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "+"\nLINE 4: distance + 20 - 2 * distance * 20 *\n                 ^\n'
2023-01-04 09:50:42,759 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree,\ndistance,\nrecording_id,\ndistance + 20 - 2 * distance * 20 *\n   SELECT ABS(degree - 10)\n     AS eucledian_distance\nFROM moods', error: SyntaxError('syntax error at or near "SELECT"\nLINE 5:    SELECT ABS(degree - 10)\n           ^')
2023-01-04 09:50:42,759 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 5:    SELECT ABS(degree - 10)\n           ^\n'
2023-01-04 09:50:42,759 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: SyntaxError('syntax error at or near "SELECT"\nLINE 5:    SELECT ABS(degree - 10)\n           ^')
2023-01-04 09:50:42,759 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 5:    SELECT ABS(degree - 10)\n           ^\n'
2023-01-04 09:52:02,650 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree,\ndistance,\nrecording_id,\ndistance + 20 - 2 * distance * 20 *\n  SELECT COS((SELECT ABS(degree - 10)))\n     AS eucledian_distance\nFROM moods', error: SyntaxError('syntax error at or near "SELECT"\nLINE 5:   SELECT COS((SELECT ABS(degree - 10)))\n          ^')
2023-01-04 09:52:02,650 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 5:   SELECT COS((SELECT ABS(degree - 10)))\n          ^\n'
2023-01-04 09:52:02,650 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: SyntaxError('syntax error at or near "SELECT"\nLINE 5:   SELECT COS((SELECT ABS(degree - 10)))\n          ^')
2023-01-04 09:52:02,651 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: syntax error at or near "SELECT"\nLINE 5:   SELECT COS((SELECT ABS(degree - 10)))\n          ^\n'
2023-01-04 09:55:23,867 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree,\ndistance,\nrecording_id,\n (SELECT SQRT((distance * distance) + (20 * 20) - 2 * distance * 20 *\n  (SELECT COS((SELECT ABS(degree - 10))))))\n     AS eucledian_distance\nFROM moods\nWHERE eucledian_distance < 10', error: UndefinedColumn('column "eucledian_distance" does not exist\nLINE 8: WHERE eucledian_distance < 10\n              ^')
2023-01-04 09:55:23,867 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "eucledian_distance" does not exist\nLINE 8: WHERE eucledian_distance < 10\n              ^\n'
2023-01-04 09:55:23,868 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: UndefinedColumn('column "eucledian_distance" does not exist\nLINE 8: WHERE eucledian_distance < 10\n              ^')
2023-01-04 09:55:23,868 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column "eucledian_distance" does not exist\nLINE 8: WHERE eucledian_distance < 10\n              ^\n'
2023-01-04 09:55:41,342 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree,\ndistance,\nrecording_id,\n (SELECT SQRT((distance * distance) + (20 * 20) - 2 * distance * 20 *\n  (SELECT COS((SELECT ABS(degree - 10))))))\n     AS eucledian_distance\nFROM moods m\nWHERE m.eucledian_distance < 10', error: UndefinedColumn('column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^')
2023-01-04 09:55:41,342 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^\n'
2023-01-04 09:55:41,343 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: UndefinedColumn('column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^')
2023-01-04 09:55:41,343 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^\n'
2023-01-04 09:55:55,143 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree,\ndistance,\nrecording_id,\n (SELECT SQRT((distance * distance) + (20 * 20) - 2 * distance * 20 *\n  (SELECT COS((SELECT ABS(degree - 10))))))\n     AS eucledian_distance\nFROM moods m\nWHERE m.eucledian_distance < 10', error: UndefinedColumn('column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^')
2023-01-04 09:55:55,144 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^\n'
2023-01-04 09:55:55,144 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: UndefinedColumn('column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^')
2023-01-04 09:55:55,144 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.UndefinedColumn: column m.eucledian_distance does not exist\nLINE 8: WHERE m.eucledian_distance < 10\n              ^\n'
2023-01-04 09:56:59,919 (357138/MainThread) pgcli.pgexecute ERROR - sql: 'SELECT degree, distance, recording_id, eucledian_distance\nFROM (\nSELECT degree,\ndistance,\nrecording_id,\n (SELECT SQRT((distance * distance) + (20 * 20) - 2 * distance * 20 *\n  (SELECT COS((SELECT ABS(degree - 10))))))\n     AS eucledian_distance\nFROM moods m\n)\nWHERE eucledian_distance < 10', error: SyntaxError('subquery in FROM must have an alias\nLINE 2: FROM (\n             ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.')
2023-01-04 09:56:59,919 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: subquery in FROM must have an alias\nLINE 2: FROM (\n             ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.\n'
2023-01-04 09:56:59,919 (357138/MainThread) pgcli.pgexecute ERROR - sql: '\\i test_queries/moods.sql', error: SyntaxError('subquery in FROM must have an alias\nLINE 2: FROM (\n             ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.')
2023-01-04 09:56:59,920 (357138/MainThread) pgcli.pgexecute ERROR - traceback: 'Traceback (most recent call last):\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 362, in run\n    for result in response:\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 373, in run\n    yield self.execute_normal_sql(sql) + (sql, True, False)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 423, in execute_normal_sql\n    cur.execute(split_sql)\n  File "/usr/lib/python3.10/site-packages/pgcli/pgexecute.py", line 69, in execute\n    super().execute(*args, **kwargs)\n  File "/usr/lib/python3.10/site-packages/psycopg/cursor.py", line 728, in execute\n    raise ex.with_traceback(None)\npsycopg.errors.SyntaxError: subquery in FROM must have an alias\nLINE 2: FROM (\n             ^\nHINT:  For example, FROM (SELECT ...) [AS] foo.\n'
2023-01-06 09:40:46,024 (38634/MainThread) pgcli.main INFO - Default pager found in PAGER environment variable: "less"
2023-01-06 09:40:46,024 (38634/MainThread) pgcli.main WARNING - import keyring failed: ModuleNotFoundError("No module named 'keyring'").
